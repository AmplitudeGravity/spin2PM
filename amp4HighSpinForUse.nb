(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    278767,       6926]
NotebookOptionsPosition[    269061,       6781]
NotebookOutlinePosition[    269701,       6802]
CellTagsIndexPosition[    269658,       6799]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Loading Packages", "Section",
 CellChangeTimes->{{3.851831445638886*^9, 
  3.851831451080901*^9}},ExpressionUUID->"0441e687-3271-491a-8955-\
dd8d0f7cb479"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  "\"\</Users/gangchen/Documents/GitHub/kinematicHopfAlgebra\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.8712808031960573`*^9, 3.871280813670759*^9}, {
  3.871289668002585*^9, 3.8712896693270063`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"96a2b633-8238-4d8a-95ef-940d2a345ea9"],

Cell[BoxData["\<\"/Users/gangchen/Documents/GitHub/kinematicHopfAlgebra\"\>"],\
 "Output",
 CellChangeTimes->{
  3.871289674788917*^9, 3.871295926960095*^9, 3.871303994346092*^9, 
   3.871304032607752*^9, 3.871431129618828*^9, 3.8716193802670317`*^9, 
   3.871621488806918*^9, 3.8716894251075706`*^9, 3.871788295452765*^9, 
   3.871788387683382*^9, 3.8719726054961*^9, 3.87197281341672*^9, 
   3.8719825926844063`*^9, 3.872033263682423*^9, 3.8720727329205*^9, 
   3.872118631225624*^9, 3.872143233303464*^9, 3.872206857678184*^9, 
   3.872208727697288*^9, 3.872224824538206*^9, 3.872294563969406*^9, 
   3.87230526297822*^9, {3.8753488646963177`*^9, 3.875348878036645*^9}, 
   3.875938469210198*^9, 3.8763667512184067`*^9, 3.876452563877585*^9, 
   3.8766114461974916`*^9, 3.876777454567438*^9, 3.876886864789299*^9, 
   3.876970198570924*^9, 3.884923310990507*^9, 3.885602032343563*^9, 
   3.888032283976047*^9, 3.8880325898967867`*^9, 3.888274328918376*^9, 
   3.888888776779451*^9, 3.891309550887192*^9, 3.891340390959291*^9, 
   3.89134058409061*^9, 3.892085072345152*^9, 3.8939758527960253`*^9, {
   3.89450087900915*^9, 3.894500893558523*^9}, 3.894685530520863*^9, 
   3.895039864999057*^9, 3.895269874438258*^9, 3.895542543965432*^9, 
   3.8957161097590647`*^9, 3.895800618287273*^9, 3.895885755118243*^9, 
   3.89605066803022*^9, 3.896949552428584*^9, 3.897697524553246*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"f745a514-280b-4f40-baf0-9a26371777c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Get", "[", "\"\<KiHA.wl\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", "\"\<MultiVariateApart.wl\>\"", "]"}]}], "Input",
 CellChangeTimes->{
  3.857017232176591*^9, {3.871280778936686*^9, 3.8712807820748453`*^9}, {
   3.871880936625079*^9, 3.871881000526787*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"9e588303-12c7-48e0-b8a5-8c3c446f4c9f"],

Cell[CellGroupData[{

Cell["\<\
 KiHA(v2.0),Copyright 2022,author Gang Chen. It is licensed under the GNU \
General Public License v3.0.
 KiHA is based on the work of Kinematic Hopf Algebra in CTP of Queen Mary \
University of London.
 It generates the duality all-n numerator for colour-kinematic duality and \
double copy in heavy mass effective 
 theory(HEFT), Yang-Mills/Gravity theory and Yang-Mills-Scalar/Gravity-Scalar. 
 KiHA is built on some basic functions written by Gustav Mogull and Gregor \
Kaelin.
 use ?KiHA`* for help and a series of papers (2111.15649, 2208.05519, \
2208.05886) for more reference.\
\>", "Print",
 CellFrame->0.5,
 CellChangeTimes->{3.897697524621545*^9},
 FontColor->RGBColor[
  0, 0, 1],ExpressionUUID->"b58b575a-eb61-4599-97be-c8431aa2cb80"],

Cell["\<\
MultivariateApart -- Multivariate partial fractions. By Matthias Heller \
(maheller@students.uni-mainz.de) and Andreas von Manteuffel (vmante@msu.edu). \
Version 2021-01-18. Please see ?MultivariateApart and ?MultivariateApart`* \
for help.\
\>", "Print",
 CellFrame->0.5,
 CellChangeTimes->{3.8976975246449347`*^9},
 FontColor->RGBColor[
  0.09375, 0.26953125, 
   0.23046875],ExpressionUUID->"79225cc0-e107-4a8d-a993-90a512885c69"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "KiHA`*"}]], "Input",
 CellChangeTimes->{{3.8952871113768997`*^9, 3.895287111378849*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"7203740e-5dea-4e1a-af94-e62a7aac051b"],

Cell[BoxData[
 StyleBox[
  FrameBox[GridBox[{
     {
      DynamicModuleBox[{Typeset`open$$ = True}, 
       PaneSelectorBox[{False->
        ButtonBox[
         RowBox[{
          
          DynamicBox[FEPrivate`FrontEndResource[
           "FEBitmaps", "RightPointerOpener"]], " ", 
          StyleBox["KiHA`", "InformationGridGroupHeader"]}],
         Appearance->None,
         BaseStyle->"InformationGridLink",
         ButtonFunction:>FEPrivate`Set[Typeset`open$$, True],
         Evaluator->Automatic,
         Method->"Preemptive"], True->
        PaneBox[GridBox[{
           {
            ButtonBox[
             RowBox[{
              
              DynamicBox[FEPrivate`FrontEndResource[
               "FEBitmaps", "DownPointerOpener"],
               ImageSizeCache->{13., {3., 10.}}], " ", 
              StyleBox["KiHA`", "InformationGridGroupHeader"]}],
             Appearance->None,
             BaseStyle->"InformationGridLink",
             ButtonFunction:>FEPrivate`Set[Typeset`open$$, False],
             Evaluator->Automatic,
             Method->"Preemptive"]},
           {
            PaneBox[GridBox[{
               {
                ButtonBox[
                 StyleBox["aMu", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "aMu", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["freeIndices", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "freeIndices", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["spAA", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "spAA", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["antiTensorQ", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "antiTensorQ", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["FT", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "FT", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["spAB", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "spAB", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["basisExpand", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "basisExpand", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["FT2F", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "FT2F", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["spB", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "spB", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["BinaryProduct", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "BinaryProduct", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["GBinaryProduct", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "GBinaryProduct", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["spBA", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "spBA", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["contract", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "contract", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["GT", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "GT", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["spBB", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "spBB", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["contractAnti", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "contractAnti", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["GT2F", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "GT2F", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["spOuter", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "spOuter", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["contractSp", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "contractSp", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["indexCoefficient", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "indexCoefficient", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["spp", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "spp", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["contractspp", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "contractspp", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["JQCD", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "JQCD", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["spQ", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "spQ", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["ddmBasis", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "ddmBasis", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["KLTR", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "KLTR", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["T", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {"T", "KiHA`"},
                    False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["declareAntisymmetric", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "declareAntisymmetric", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["KLTRM", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "KLTRM", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["T2F", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "T2F", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["declareAntiTensorHead", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "declareAntiTensorHead", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["KSetPartitions", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "KSetPartitions", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["tensorDim", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "tensorDim", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["declareDistributive", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "declareDistributive", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["KSetPartitionsEmpty", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "KSetPartitionsEmpty", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["tensorQ", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "tensorQ", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["declareDistributiveFirst", "InformationGridButton"],
                 
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "declareDistributiveFirst", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["lgScaling", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "lgScaling", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["tensorQR2", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "tensorQR2", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["declareDistributiveLast", "InformationGridButton"],
                 
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "declareDistributiveLast", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["lI", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "lI", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["tensorRank", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "tensorRank", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 
                 StyleBox["declareDistributiveMiddle", 
                  "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "declareDistributiveMiddle", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["m", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {"m", "KiHA`"},
                    False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["toSpinors", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "toSpinors", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["declareSymmetric", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "declareSymmetric", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["massDim", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "massDim", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["tr", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "tr", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["declareTensor", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "declareTensor", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["mu", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "mu", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["undeclareTensor", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "undeclareTensor", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["declareTensorHead", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "declareTensorHead", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["NC", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "NC", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["undeclareTensorHead", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "undeclareTensorHead", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["declareVector", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "declareVector", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["nice", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "nice", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["v", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {"v", "KiHA`"},
                    False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["declareVectorHead", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "declareVectorHead", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["niceT", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "niceT", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["vectorQ", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "vectorQ", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["distributive", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "distributive", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["NumRec", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "NumRec", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["verbose", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "verbose", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["distributiveRules", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "distributiveRules", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["numRecQCD", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "numRecQCD", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["X", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {"X", "KiHA`"},
                    False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["dot", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "dot", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["outer", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "outer", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["X2Prop", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "X2Prop", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["dressIndex", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "dressIndex", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["p", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {"p", "KiHA`"},
                    False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["\[ScriptCapitalK]", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "\[ScriptCapitalK]", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["eps", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "eps", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["parkeTaylor", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "parkeTaylor", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["\[DoubleStruckA]", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "\[DoubleStruckA]", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["ET", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "ET", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["patternFreeQ", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "patternFreeQ", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["\[DoubleStruckCapitalI]", "InformationGridButton"],
                 
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "\[DoubleStruckCapitalI]", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["ET2F", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "ET2F", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["protectedQ", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "protectedQ", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["\[DoubleStruckCapitalS]", "InformationGridButton"],
                 
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "\[DoubleStruckCapitalS]", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["ET2F2s", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "ET2F2s", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["p$", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "p$", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["\[DoubleStruckT]", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "\[DoubleStruckT]", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["eta", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "eta", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["rmzero", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "rmzero", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["\[CapitalDelta]", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "\[CapitalDelta]", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["ExpandNCM", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "ExpandNCM", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["rmzeroT", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "rmzeroT", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["\[Epsilon]", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "\[Epsilon]", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["expandTensor", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "expandTensor", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["setGlobalDim", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "setGlobalDim", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["\[CapitalOmega]", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "\[CapitalOmega]", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["exposeIndex", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "exposeIndex", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["SetPartitionsOrdered", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "SetPartitionsOrdered", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["\[FivePointedStar]", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "\[FivePointedStar]", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic]},
               {
                ButtonBox[
                 StyleBox["F", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {"F", "KiHA`"},
                    False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["sp", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "sp", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], ""},
               {
                ButtonBox[
                 StyleBox["FRank2", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "FRank2", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], 
                ButtonBox[
                 StyleBox["spA", "InformationGridButton"],
                 Appearance->None,
                 BaseStyle->"InformationGridLink",
                 
                 ButtonData:>{
                  "Info-711a6320-15ae-494f-9d04-bb2cee8ce408", {
                   "spA", "KiHA`"}, False},
                 ButtonNote->"KiHA`",
                 Evaluator->Automatic], ""}
              },
              DefaultBaseStyle->"Text",
              
              GridBoxAlignment->{
               "Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
              GridBoxItemSize->{"Columns" -> {{
                   Scaled[0.31666666666666665`]}}}],
             ImageMargins->{{10, 0}, {0, 2}}]}
          },
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}}],
         FrameMargins->{{0, 0}, {8, 0}}]}, Dynamic[Typeset`open$$],
        ImageSize->Automatic]]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxDividers->{"ColumnsIndexed" -> {{False}}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.8]}, 
        Offset[0.2]}}],
   BaseStyle->"InformationTitleFrame"], "InformationGridPlain"]], "Output",
 CellChangeTimes->{3.895287111939122*^9, 3.895716109964012*^9, 
  3.895800618435419*^9, 3.8958857553036327`*^9, 3.896050668212237*^9, 
  3.8969495525875053`*^9, 3.897697524729568*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"d1bc3aad-6d3d-46c8-a68a-d0adb7426c33"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"p", ",", "F", ",", "\[Epsilon]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"declareVectorHead", "[", 
  RowBox[{"{", 
   RowBox[{
   "p", ",", "q", ",", "l", ",", "\[Epsilon]", ",", "v", ",", "w", ",", "a"}],
    "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"declareTensorHead", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"F", ",", "H", ",", "W", ",", "V", ",", "S"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<rank\>\"", "\[Rule]", " ", "2"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"declareAntiTensorHead", "[", 
  RowBox[{"{", 
   RowBox[{"F", ",", "H", ",", "S"}], "}"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", 
   RowBox[{"p", ",", "F", ",", "\[Epsilon]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQfVK+m4d7/RtHuy05vCA6Qvf3HBB948ul+SD6WBar
Ay+QXt5qDqaX5PtHaAPplk8RYPpNtwST8qY3jhNu+4PpJvWNJ6U2v3H8MO04
mJb8Iug4F0jXBV4C06cK64Wzt7xxVLFaAqbXZJS+LtkKtCdyMpiep6bGMPHq
G0eLH3pgut5v5qVdQLqhdhuYFn0sE7kbSJvYmoDplD3pu02uvXE0cywF0zGG
P26+vA4Uf+p9D0R/yTuo+xZIs3Bv1gfRP3buXdzz6I2jRN0VMG21pNfk+cc3
jqUTL4PpniVGWa+BdFPXhBwQLS3gyqDD+tZxH0sBmAYAjSGiZA==
  "],
 CellLabel->"In[5]:=",ExpressionUUID->"6e78fb49-dd55-4145-92f6-d81f0c875850"],

Cell[CellGroupData[{

Cell[BoxData["\<\"p declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.857017258021285*^9, 3.857205455995563*^9, 3.8574479786122217`*^9, 
   3.857449026567123*^9, 3.857450053296307*^9, 3.858654105129344*^9, 
   3.859348922277046*^9, 3.859452101079454*^9, 3.859713337485505*^9, 
   3.86013749105093*^9, 3.860555719961184*^9, 3.860629326098345*^9, 
   3.860844158728386*^9, 3.861081536028767*^9, 3.861262791601131*^9, 
   3.8615005249145308`*^9, 3.869648866248951*^9, 3.869649217071579*^9, 
   3.870066690323264*^9, 3.870150190777561*^9, 3.870152342640258*^9, 
   3.8701534202589808`*^9, 3.870236122409807*^9, 3.8702549083942337`*^9, 
   3.870260364806555*^9, 3.870401766898699*^9, 3.8704020123375387`*^9, 
   3.870494349798994*^9, 3.87059014524513*^9, 3.870652011749073*^9, 
   3.870654963278955*^9, 3.870674576138321*^9, 3.870743062886133*^9, 
   3.870819879887828*^9, 3.870829357322528*^9, 3.8709317613543777`*^9, 
   3.871011277711314*^9, 3.871012863768826*^9, 3.871168338208912*^9, 
   3.871184492077347*^9, 3.871185617354723*^9, 3.8712055200529346`*^9, {
   3.87129726065751*^9, 3.871297268011313*^9}, 3.871304062246093*^9, 
   3.8716194298578444`*^9, 3.871621513244425*^9, 3.871689433507557*^9, 
   3.8717884381507473`*^9, 3.8717946268623123`*^9, 3.871881006486046*^9, 
   3.871972611380741*^9, 3.871982606053879*^9, 3.872033438356305*^9, 
   3.872072739458227*^9, 3.872118638192325*^9, 3.8721432436469183`*^9, 
   3.872206866116229*^9, 3.872208727857349*^9, 3.872224824689538*^9, 
   3.872294569501293*^9, 3.872305263153335*^9, 3.875348925687496*^9, 
   3.875938480412423*^9, 3.876366759630951*^9, 3.8764526041903133`*^9, 
   3.8766114463684177`*^9, 3.876777454764464*^9, 3.876873445731583*^9, 
   3.876874700381797*^9, 3.876886864903775*^9, 3.876970198753796*^9, 
   3.884923311143351*^9, 3.884931941221653*^9, 3.885602032461825*^9, 
   3.888032284103799*^9, 3.888032590031375*^9, 3.888274329041766*^9, 
   3.888888776901124*^9, 3.891309551005546*^9, 3.891340391081622*^9, 
   3.891340584196597*^9, 3.892085072467169*^9, 3.893975852920947*^9, {
   3.89450087923026*^9, 3.8945008936657877`*^9}, 3.894685530632435*^9, 
   3.895039871910738*^9, 3.8952698745775747`*^9, 3.8955425546416187`*^9, 
   3.895716109980179*^9, 3.89580061845199*^9, 3.895885755318775*^9, 
   3.89605066822718*^9, 3.896949552605785*^9, 3.897697524748934*^9},
 CellLabel->
  "During evaluation of \
In[5]:=",ExpressionUUID->"bb2357e3-7368-4b2c-b5b4-014dc25a4d3a"],

Cell[BoxData["\<\"q declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.857017258021285*^9, 3.857205455995563*^9, 3.8574479786122217`*^9, 
   3.857449026567123*^9, 3.857450053296307*^9, 3.858654105129344*^9, 
   3.859348922277046*^9, 3.859452101079454*^9, 3.859713337485505*^9, 
   3.86013749105093*^9, 3.860555719961184*^9, 3.860629326098345*^9, 
   3.860844158728386*^9, 3.861081536028767*^9, 3.861262791601131*^9, 
   3.8615005249145308`*^9, 3.869648866248951*^9, 3.869649217071579*^9, 
   3.870066690323264*^9, 3.870150190777561*^9, 3.870152342640258*^9, 
   3.8701534202589808`*^9, 3.870236122409807*^9, 3.8702549083942337`*^9, 
   3.870260364806555*^9, 3.870401766898699*^9, 3.8704020123375387`*^9, 
   3.870494349798994*^9, 3.87059014524513*^9, 3.870652011749073*^9, 
   3.870654963278955*^9, 3.870674576138321*^9, 3.870743062886133*^9, 
   3.870819879887828*^9, 3.870829357322528*^9, 3.8709317613543777`*^9, 
   3.871011277711314*^9, 3.871012863768826*^9, 3.871168338208912*^9, 
   3.871184492077347*^9, 3.871185617354723*^9, 3.8712055200529346`*^9, {
   3.87129726065751*^9, 3.871297268011313*^9}, 3.871304062246093*^9, 
   3.8716194298578444`*^9, 3.871621513244425*^9, 3.871689433507557*^9, 
   3.8717884381507473`*^9, 3.8717946268623123`*^9, 3.871881006486046*^9, 
   3.871972611380741*^9, 3.871982606053879*^9, 3.872033438356305*^9, 
   3.872072739458227*^9, 3.872118638192325*^9, 3.8721432436469183`*^9, 
   3.872206866116229*^9, 3.872208727857349*^9, 3.872224824689538*^9, 
   3.872294569501293*^9, 3.872305263153335*^9, 3.875348925687496*^9, 
   3.875938480412423*^9, 3.876366759630951*^9, 3.8764526041903133`*^9, 
   3.8766114463684177`*^9, 3.876777454764464*^9, 3.876873445731583*^9, 
   3.876874700381797*^9, 3.876886864903775*^9, 3.876970198753796*^9, 
   3.884923311143351*^9, 3.884931941221653*^9, 3.885602032461825*^9, 
   3.888032284103799*^9, 3.888032590031375*^9, 3.888274329041766*^9, 
   3.888888776901124*^9, 3.891309551005546*^9, 3.891340391081622*^9, 
   3.891340584196597*^9, 3.892085072467169*^9, 3.893975852920947*^9, {
   3.89450087923026*^9, 3.8945008936657877`*^9}, 3.894685530632435*^9, 
   3.895039871910738*^9, 3.8952698745775747`*^9, 3.8955425546416187`*^9, 
   3.895716109980179*^9, 3.89580061845199*^9, 3.895885755318775*^9, 
   3.89605066822718*^9, 3.896949552605785*^9, 3.897697524752234*^9},
 CellLabel->
  "During evaluation of \
In[5]:=",ExpressionUUID->"3c3aaaa7-0f11-4086-bfa1-8e4e5e9eb6fb"],

Cell[BoxData["\<\"l declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.857017258021285*^9, 3.857205455995563*^9, 3.8574479786122217`*^9, 
   3.857449026567123*^9, 3.857450053296307*^9, 3.858654105129344*^9, 
   3.859348922277046*^9, 3.859452101079454*^9, 3.859713337485505*^9, 
   3.86013749105093*^9, 3.860555719961184*^9, 3.860629326098345*^9, 
   3.860844158728386*^9, 3.861081536028767*^9, 3.861262791601131*^9, 
   3.8615005249145308`*^9, 3.869648866248951*^9, 3.869649217071579*^9, 
   3.870066690323264*^9, 3.870150190777561*^9, 3.870152342640258*^9, 
   3.8701534202589808`*^9, 3.870236122409807*^9, 3.8702549083942337`*^9, 
   3.870260364806555*^9, 3.870401766898699*^9, 3.8704020123375387`*^9, 
   3.870494349798994*^9, 3.87059014524513*^9, 3.870652011749073*^9, 
   3.870654963278955*^9, 3.870674576138321*^9, 3.870743062886133*^9, 
   3.870819879887828*^9, 3.870829357322528*^9, 3.8709317613543777`*^9, 
   3.871011277711314*^9, 3.871012863768826*^9, 3.871168338208912*^9, 
   3.871184492077347*^9, 3.871185617354723*^9, 3.8712055200529346`*^9, {
   3.87129726065751*^9, 3.871297268011313*^9}, 3.871304062246093*^9, 
   3.8716194298578444`*^9, 3.871621513244425*^9, 3.871689433507557*^9, 
   3.8717884381507473`*^9, 3.8717946268623123`*^9, 3.871881006486046*^9, 
   3.871972611380741*^9, 3.871982606053879*^9, 3.872033438356305*^9, 
   3.872072739458227*^9, 3.872118638192325*^9, 3.8721432436469183`*^9, 
   3.872206866116229*^9, 3.872208727857349*^9, 3.872224824689538*^9, 
   3.872294569501293*^9, 3.872305263153335*^9, 3.875348925687496*^9, 
   3.875938480412423*^9, 3.876366759630951*^9, 3.8764526041903133`*^9, 
   3.8766114463684177`*^9, 3.876777454764464*^9, 3.876873445731583*^9, 
   3.876874700381797*^9, 3.876886864903775*^9, 3.876970198753796*^9, 
   3.884923311143351*^9, 3.884931941221653*^9, 3.885602032461825*^9, 
   3.888032284103799*^9, 3.888032590031375*^9, 3.888274329041766*^9, 
   3.888888776901124*^9, 3.891309551005546*^9, 3.891340391081622*^9, 
   3.891340584196597*^9, 3.892085072467169*^9, 3.893975852920947*^9, {
   3.89450087923026*^9, 3.8945008936657877`*^9}, 3.894685530632435*^9, 
   3.895039871910738*^9, 3.8952698745775747`*^9, 3.8955425546416187`*^9, 
   3.895716109980179*^9, 3.89580061845199*^9, 3.895885755318775*^9, 
   3.89605066822718*^9, 3.896949552605785*^9, 3.89769752475558*^9},
 CellLabel->
  "During evaluation of \
In[5]:=",ExpressionUUID->"9f1be2a2-b913-468e-900d-b2d5561cc3dc"],

Cell[BoxData["\<\"\[Epsilon] declared as a 4-dimensional vector \
header.\"\>"], "Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.857017258021285*^9, 3.857205455995563*^9, 3.8574479786122217`*^9, 
   3.857449026567123*^9, 3.857450053296307*^9, 3.858654105129344*^9, 
   3.859348922277046*^9, 3.859452101079454*^9, 3.859713337485505*^9, 
   3.86013749105093*^9, 3.860555719961184*^9, 3.860629326098345*^9, 
   3.860844158728386*^9, 3.861081536028767*^9, 3.861262791601131*^9, 
   3.8615005249145308`*^9, 3.869648866248951*^9, 3.869649217071579*^9, 
   3.870066690323264*^9, 3.870150190777561*^9, 3.870152342640258*^9, 
   3.8701534202589808`*^9, 3.870236122409807*^9, 3.8702549083942337`*^9, 
   3.870260364806555*^9, 3.870401766898699*^9, 3.8704020123375387`*^9, 
   3.870494349798994*^9, 3.87059014524513*^9, 3.870652011749073*^9, 
   3.870654963278955*^9, 3.870674576138321*^9, 3.870743062886133*^9, 
   3.870819879887828*^9, 3.870829357322528*^9, 3.8709317613543777`*^9, 
   3.871011277711314*^9, 3.871012863768826*^9, 3.871168338208912*^9, 
   3.871184492077347*^9, 3.871185617354723*^9, 3.8712055200529346`*^9, {
   3.87129726065751*^9, 3.871297268011313*^9}, 3.871304062246093*^9, 
   3.8716194298578444`*^9, 3.871621513244425*^9, 3.871689433507557*^9, 
   3.8717884381507473`*^9, 3.8717946268623123`*^9, 3.871881006486046*^9, 
   3.871972611380741*^9, 3.871982606053879*^9, 3.872033438356305*^9, 
   3.872072739458227*^9, 3.872118638192325*^9, 3.8721432436469183`*^9, 
   3.872206866116229*^9, 3.872208727857349*^9, 3.872224824689538*^9, 
   3.872294569501293*^9, 3.872305263153335*^9, 3.875348925687496*^9, 
   3.875938480412423*^9, 3.876366759630951*^9, 3.8764526041903133`*^9, 
   3.8766114463684177`*^9, 3.876777454764464*^9, 3.876873445731583*^9, 
   3.876874700381797*^9, 3.876886864903775*^9, 3.876970198753796*^9, 
   3.884923311143351*^9, 3.884931941221653*^9, 3.885602032461825*^9, 
   3.888032284103799*^9, 3.888032590031375*^9, 3.888274329041766*^9, 
   3.888888776901124*^9, 3.891309551005546*^9, 3.891340391081622*^9, 
   3.891340584196597*^9, 3.892085072467169*^9, 3.893975852920947*^9, {
   3.89450087923026*^9, 3.8945008936657877`*^9}, 3.894685530632435*^9, 
   3.895039871910738*^9, 3.8952698745775747`*^9, 3.8955425546416187`*^9, 
   3.895716109980179*^9, 3.89580061845199*^9, 3.895885755318775*^9, 
   3.89605066822718*^9, 3.896949552605785*^9, 3.897697524757997*^9},
 CellLabel->
  "During evaluation of \
In[5]:=",ExpressionUUID->"e8ce5606-039c-4eba-ab0b-81d782101309"],

Cell[BoxData["\<\"v declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.857017258021285*^9, 3.857205455995563*^9, 3.8574479786122217`*^9, 
   3.857449026567123*^9, 3.857450053296307*^9, 3.858654105129344*^9, 
   3.859348922277046*^9, 3.859452101079454*^9, 3.859713337485505*^9, 
   3.86013749105093*^9, 3.860555719961184*^9, 3.860629326098345*^9, 
   3.860844158728386*^9, 3.861081536028767*^9, 3.861262791601131*^9, 
   3.8615005249145308`*^9, 3.869648866248951*^9, 3.869649217071579*^9, 
   3.870066690323264*^9, 3.870150190777561*^9, 3.870152342640258*^9, 
   3.8701534202589808`*^9, 3.870236122409807*^9, 3.8702549083942337`*^9, 
   3.870260364806555*^9, 3.870401766898699*^9, 3.8704020123375387`*^9, 
   3.870494349798994*^9, 3.87059014524513*^9, 3.870652011749073*^9, 
   3.870654963278955*^9, 3.870674576138321*^9, 3.870743062886133*^9, 
   3.870819879887828*^9, 3.870829357322528*^9, 3.8709317613543777`*^9, 
   3.871011277711314*^9, 3.871012863768826*^9, 3.871168338208912*^9, 
   3.871184492077347*^9, 3.871185617354723*^9, 3.8712055200529346`*^9, {
   3.87129726065751*^9, 3.871297268011313*^9}, 3.871304062246093*^9, 
   3.8716194298578444`*^9, 3.871621513244425*^9, 3.871689433507557*^9, 
   3.8717884381507473`*^9, 3.8717946268623123`*^9, 3.871881006486046*^9, 
   3.871972611380741*^9, 3.871982606053879*^9, 3.872033438356305*^9, 
   3.872072739458227*^9, 3.872118638192325*^9, 3.8721432436469183`*^9, 
   3.872206866116229*^9, 3.872208727857349*^9, 3.872224824689538*^9, 
   3.872294569501293*^9, 3.872305263153335*^9, 3.875348925687496*^9, 
   3.875938480412423*^9, 3.876366759630951*^9, 3.8764526041903133`*^9, 
   3.8766114463684177`*^9, 3.876777454764464*^9, 3.876873445731583*^9, 
   3.876874700381797*^9, 3.876886864903775*^9, 3.876970198753796*^9, 
   3.884923311143351*^9, 3.884931941221653*^9, 3.885602032461825*^9, 
   3.888032284103799*^9, 3.888032590031375*^9, 3.888274329041766*^9, 
   3.888888776901124*^9, 3.891309551005546*^9, 3.891340391081622*^9, 
   3.891340584196597*^9, 3.892085072467169*^9, 3.893975852920947*^9, {
   3.89450087923026*^9, 3.8945008936657877`*^9}, 3.894685530632435*^9, 
   3.895039871910738*^9, 3.8952698745775747`*^9, 3.8955425546416187`*^9, 
   3.895716109980179*^9, 3.89580061845199*^9, 3.895885755318775*^9, 
   3.89605066822718*^9, 3.896949552605785*^9, 3.897697524760585*^9},
 CellLabel->
  "During evaluation of \
In[5]:=",ExpressionUUID->"3dc66d7b-3ed3-4434-8ccd-a438169f87af"],

Cell[BoxData["\<\"w declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.857017258021285*^9, 3.857205455995563*^9, 3.8574479786122217`*^9, 
   3.857449026567123*^9, 3.857450053296307*^9, 3.858654105129344*^9, 
   3.859348922277046*^9, 3.859452101079454*^9, 3.859713337485505*^9, 
   3.86013749105093*^9, 3.860555719961184*^9, 3.860629326098345*^9, 
   3.860844158728386*^9, 3.861081536028767*^9, 3.861262791601131*^9, 
   3.8615005249145308`*^9, 3.869648866248951*^9, 3.869649217071579*^9, 
   3.870066690323264*^9, 3.870150190777561*^9, 3.870152342640258*^9, 
   3.8701534202589808`*^9, 3.870236122409807*^9, 3.8702549083942337`*^9, 
   3.870260364806555*^9, 3.870401766898699*^9, 3.8704020123375387`*^9, 
   3.870494349798994*^9, 3.87059014524513*^9, 3.870652011749073*^9, 
   3.870654963278955*^9, 3.870674576138321*^9, 3.870743062886133*^9, 
   3.870819879887828*^9, 3.870829357322528*^9, 3.8709317613543777`*^9, 
   3.871011277711314*^9, 3.871012863768826*^9, 3.871168338208912*^9, 
   3.871184492077347*^9, 3.871185617354723*^9, 3.8712055200529346`*^9, {
   3.87129726065751*^9, 3.871297268011313*^9}, 3.871304062246093*^9, 
   3.8716194298578444`*^9, 3.871621513244425*^9, 3.871689433507557*^9, 
   3.8717884381507473`*^9, 3.8717946268623123`*^9, 3.871881006486046*^9, 
   3.871972611380741*^9, 3.871982606053879*^9, 3.872033438356305*^9, 
   3.872072739458227*^9, 3.872118638192325*^9, 3.8721432436469183`*^9, 
   3.872206866116229*^9, 3.872208727857349*^9, 3.872224824689538*^9, 
   3.872294569501293*^9, 3.872305263153335*^9, 3.875348925687496*^9, 
   3.875938480412423*^9, 3.876366759630951*^9, 3.8764526041903133`*^9, 
   3.8766114463684177`*^9, 3.876777454764464*^9, 3.876873445731583*^9, 
   3.876874700381797*^9, 3.876886864903775*^9, 3.876970198753796*^9, 
   3.884923311143351*^9, 3.884931941221653*^9, 3.885602032461825*^9, 
   3.888032284103799*^9, 3.888032590031375*^9, 3.888274329041766*^9, 
   3.888888776901124*^9, 3.891309551005546*^9, 3.891340391081622*^9, 
   3.891340584196597*^9, 3.892085072467169*^9, 3.893975852920947*^9, {
   3.89450087923026*^9, 3.8945008936657877`*^9}, 3.894685530632435*^9, 
   3.895039871910738*^9, 3.8952698745775747`*^9, 3.8955425546416187`*^9, 
   3.895716109980179*^9, 3.89580061845199*^9, 3.895885755318775*^9, 
   3.89605066822718*^9, 3.896949552605785*^9, 3.897697524763014*^9},
 CellLabel->
  "During evaluation of \
In[5]:=",ExpressionUUID->"147b3006-f9c5-473b-8340-0d06f66fb986"],

Cell[BoxData["\<\"a declared as a 4-dimensional vector header.\"\>"], "Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.857017258021285*^9, 3.857205455995563*^9, 3.8574479786122217`*^9, 
   3.857449026567123*^9, 3.857450053296307*^9, 3.858654105129344*^9, 
   3.859348922277046*^9, 3.859452101079454*^9, 3.859713337485505*^9, 
   3.86013749105093*^9, 3.860555719961184*^9, 3.860629326098345*^9, 
   3.860844158728386*^9, 3.861081536028767*^9, 3.861262791601131*^9, 
   3.8615005249145308`*^9, 3.869648866248951*^9, 3.869649217071579*^9, 
   3.870066690323264*^9, 3.870150190777561*^9, 3.870152342640258*^9, 
   3.8701534202589808`*^9, 3.870236122409807*^9, 3.8702549083942337`*^9, 
   3.870260364806555*^9, 3.870401766898699*^9, 3.8704020123375387`*^9, 
   3.870494349798994*^9, 3.87059014524513*^9, 3.870652011749073*^9, 
   3.870654963278955*^9, 3.870674576138321*^9, 3.870743062886133*^9, 
   3.870819879887828*^9, 3.870829357322528*^9, 3.8709317613543777`*^9, 
   3.871011277711314*^9, 3.871012863768826*^9, 3.871168338208912*^9, 
   3.871184492077347*^9, 3.871185617354723*^9, 3.8712055200529346`*^9, {
   3.87129726065751*^9, 3.871297268011313*^9}, 3.871304062246093*^9, 
   3.8716194298578444`*^9, 3.871621513244425*^9, 3.871689433507557*^9, 
   3.8717884381507473`*^9, 3.8717946268623123`*^9, 3.871881006486046*^9, 
   3.871972611380741*^9, 3.871982606053879*^9, 3.872033438356305*^9, 
   3.872072739458227*^9, 3.872118638192325*^9, 3.8721432436469183`*^9, 
   3.872206866116229*^9, 3.872208727857349*^9, 3.872224824689538*^9, 
   3.872294569501293*^9, 3.872305263153335*^9, 3.875348925687496*^9, 
   3.875938480412423*^9, 3.876366759630951*^9, 3.8764526041903133`*^9, 
   3.8766114463684177`*^9, 3.876777454764464*^9, 3.876873445731583*^9, 
   3.876874700381797*^9, 3.876886864903775*^9, 3.876970198753796*^9, 
   3.884923311143351*^9, 3.884931941221653*^9, 3.885602032461825*^9, 
   3.888032284103799*^9, 3.888032590031375*^9, 3.888274329041766*^9, 
   3.888888776901124*^9, 3.891309551005546*^9, 3.891340391081622*^9, 
   3.891340584196597*^9, 3.892085072467169*^9, 3.893975852920947*^9, {
   3.89450087923026*^9, 3.8945008936657877`*^9}, 3.894685530632435*^9, 
   3.895039871910738*^9, 3.8952698745775747`*^9, 3.8955425546416187`*^9, 
   3.895716109980179*^9, 3.89580061845199*^9, 3.895885755318775*^9, 
   3.89605066822718*^9, 3.896949552605785*^9, 3.897697524765441*^9},
 CellLabel->
  "During evaluation of \
In[5]:=",ExpressionUUID->"e58d77d5-64ac-439b-a084-03b2cc599d51"],

Cell[BoxData["\<\"F declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.857017258021285*^9, 3.857205455995563*^9, 3.8574479786122217`*^9, 
   3.857449026567123*^9, 3.857450053296307*^9, 3.858654105129344*^9, 
   3.859348922277046*^9, 3.859452101079454*^9, 3.859713337485505*^9, 
   3.86013749105093*^9, 3.860555719961184*^9, 3.860629326098345*^9, 
   3.860844158728386*^9, 3.861081536028767*^9, 3.861262791601131*^9, 
   3.8615005249145308`*^9, 3.869648866248951*^9, 3.869649217071579*^9, 
   3.870066690323264*^9, 3.870150190777561*^9, 3.870152342640258*^9, 
   3.8701534202589808`*^9, 3.870236122409807*^9, 3.8702549083942337`*^9, 
   3.870260364806555*^9, 3.870401766898699*^9, 3.8704020123375387`*^9, 
   3.870494349798994*^9, 3.87059014524513*^9, 3.870652011749073*^9, 
   3.870654963278955*^9, 3.870674576138321*^9, 3.870743062886133*^9, 
   3.870819879887828*^9, 3.870829357322528*^9, 3.8709317613543777`*^9, 
   3.871011277711314*^9, 3.871012863768826*^9, 3.871168338208912*^9, 
   3.871184492077347*^9, 3.871185617354723*^9, 3.8712055200529346`*^9, {
   3.87129726065751*^9, 3.871297268011313*^9}, 3.871304062246093*^9, 
   3.8716194298578444`*^9, 3.871621513244425*^9, 3.871689433507557*^9, 
   3.8717884381507473`*^9, 3.8717946268623123`*^9, 3.871881006486046*^9, 
   3.871972611380741*^9, 3.871982606053879*^9, 3.872033438356305*^9, 
   3.872072739458227*^9, 3.872118638192325*^9, 3.8721432436469183`*^9, 
   3.872206866116229*^9, 3.872208727857349*^9, 3.872224824689538*^9, 
   3.872294569501293*^9, 3.872305263153335*^9, 3.875348925687496*^9, 
   3.875938480412423*^9, 3.876366759630951*^9, 3.8764526041903133`*^9, 
   3.8766114463684177`*^9, 3.876777454764464*^9, 3.876873445731583*^9, 
   3.876874700381797*^9, 3.876886864903775*^9, 3.876970198753796*^9, 
   3.884923311143351*^9, 3.884931941221653*^9, 3.885602032461825*^9, 
   3.888032284103799*^9, 3.888032590031375*^9, 3.888274329041766*^9, 
   3.888888776901124*^9, 3.891309551005546*^9, 3.891340391081622*^9, 
   3.891340584196597*^9, 3.892085072467169*^9, 3.893975852920947*^9, {
   3.89450087923026*^9, 3.8945008936657877`*^9}, 3.894685530632435*^9, 
   3.895039871910738*^9, 3.8952698745775747`*^9, 3.8955425546416187`*^9, 
   3.895716109980179*^9, 3.89580061845199*^9, 3.895885755318775*^9, 
   3.89605066822718*^9, 3.896949552605785*^9, 3.897697524767851*^9},
 CellLabel->
  "During evaluation of \
In[5]:=",ExpressionUUID->"01d469a9-aa67-4fba-8722-1d5ceceb8817"],

Cell[BoxData["\<\"H declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.857017258021285*^9, 3.857205455995563*^9, 3.8574479786122217`*^9, 
   3.857449026567123*^9, 3.857450053296307*^9, 3.858654105129344*^9, 
   3.859348922277046*^9, 3.859452101079454*^9, 3.859713337485505*^9, 
   3.86013749105093*^9, 3.860555719961184*^9, 3.860629326098345*^9, 
   3.860844158728386*^9, 3.861081536028767*^9, 3.861262791601131*^9, 
   3.8615005249145308`*^9, 3.869648866248951*^9, 3.869649217071579*^9, 
   3.870066690323264*^9, 3.870150190777561*^9, 3.870152342640258*^9, 
   3.8701534202589808`*^9, 3.870236122409807*^9, 3.8702549083942337`*^9, 
   3.870260364806555*^9, 3.870401766898699*^9, 3.8704020123375387`*^9, 
   3.870494349798994*^9, 3.87059014524513*^9, 3.870652011749073*^9, 
   3.870654963278955*^9, 3.870674576138321*^9, 3.870743062886133*^9, 
   3.870819879887828*^9, 3.870829357322528*^9, 3.8709317613543777`*^9, 
   3.871011277711314*^9, 3.871012863768826*^9, 3.871168338208912*^9, 
   3.871184492077347*^9, 3.871185617354723*^9, 3.8712055200529346`*^9, {
   3.87129726065751*^9, 3.871297268011313*^9}, 3.871304062246093*^9, 
   3.8716194298578444`*^9, 3.871621513244425*^9, 3.871689433507557*^9, 
   3.8717884381507473`*^9, 3.8717946268623123`*^9, 3.871881006486046*^9, 
   3.871972611380741*^9, 3.871982606053879*^9, 3.872033438356305*^9, 
   3.872072739458227*^9, 3.872118638192325*^9, 3.8721432436469183`*^9, 
   3.872206866116229*^9, 3.872208727857349*^9, 3.872224824689538*^9, 
   3.872294569501293*^9, 3.872305263153335*^9, 3.875348925687496*^9, 
   3.875938480412423*^9, 3.876366759630951*^9, 3.8764526041903133`*^9, 
   3.8766114463684177`*^9, 3.876777454764464*^9, 3.876873445731583*^9, 
   3.876874700381797*^9, 3.876886864903775*^9, 3.876970198753796*^9, 
   3.884923311143351*^9, 3.884931941221653*^9, 3.885602032461825*^9, 
   3.888032284103799*^9, 3.888032590031375*^9, 3.888274329041766*^9, 
   3.888888776901124*^9, 3.891309551005546*^9, 3.891340391081622*^9, 
   3.891340584196597*^9, 3.892085072467169*^9, 3.893975852920947*^9, {
   3.89450087923026*^9, 3.8945008936657877`*^9}, 3.894685530632435*^9, 
   3.895039871910738*^9, 3.8952698745775747`*^9, 3.8955425546416187`*^9, 
   3.895716109980179*^9, 3.89580061845199*^9, 3.895885755318775*^9, 
   3.89605066822718*^9, 3.896949552605785*^9, 3.897697524770232*^9},
 CellLabel->
  "During evaluation of \
In[5]:=",ExpressionUUID->"2dd28bd3-5d25-4a68-a52e-e39ebf17f227"],

Cell[BoxData["\<\"W declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.857017258021285*^9, 3.857205455995563*^9, 3.8574479786122217`*^9, 
   3.857449026567123*^9, 3.857450053296307*^9, 3.858654105129344*^9, 
   3.859348922277046*^9, 3.859452101079454*^9, 3.859713337485505*^9, 
   3.86013749105093*^9, 3.860555719961184*^9, 3.860629326098345*^9, 
   3.860844158728386*^9, 3.861081536028767*^9, 3.861262791601131*^9, 
   3.8615005249145308`*^9, 3.869648866248951*^9, 3.869649217071579*^9, 
   3.870066690323264*^9, 3.870150190777561*^9, 3.870152342640258*^9, 
   3.8701534202589808`*^9, 3.870236122409807*^9, 3.8702549083942337`*^9, 
   3.870260364806555*^9, 3.870401766898699*^9, 3.8704020123375387`*^9, 
   3.870494349798994*^9, 3.87059014524513*^9, 3.870652011749073*^9, 
   3.870654963278955*^9, 3.870674576138321*^9, 3.870743062886133*^9, 
   3.870819879887828*^9, 3.870829357322528*^9, 3.8709317613543777`*^9, 
   3.871011277711314*^9, 3.871012863768826*^9, 3.871168338208912*^9, 
   3.871184492077347*^9, 3.871185617354723*^9, 3.8712055200529346`*^9, {
   3.87129726065751*^9, 3.871297268011313*^9}, 3.871304062246093*^9, 
   3.8716194298578444`*^9, 3.871621513244425*^9, 3.871689433507557*^9, 
   3.8717884381507473`*^9, 3.8717946268623123`*^9, 3.871881006486046*^9, 
   3.871972611380741*^9, 3.871982606053879*^9, 3.872033438356305*^9, 
   3.872072739458227*^9, 3.872118638192325*^9, 3.8721432436469183`*^9, 
   3.872206866116229*^9, 3.872208727857349*^9, 3.872224824689538*^9, 
   3.872294569501293*^9, 3.872305263153335*^9, 3.875348925687496*^9, 
   3.875938480412423*^9, 3.876366759630951*^9, 3.8764526041903133`*^9, 
   3.8766114463684177`*^9, 3.876777454764464*^9, 3.876873445731583*^9, 
   3.876874700381797*^9, 3.876886864903775*^9, 3.876970198753796*^9, 
   3.884923311143351*^9, 3.884931941221653*^9, 3.885602032461825*^9, 
   3.888032284103799*^9, 3.888032590031375*^9, 3.888274329041766*^9, 
   3.888888776901124*^9, 3.891309551005546*^9, 3.891340391081622*^9, 
   3.891340584196597*^9, 3.892085072467169*^9, 3.893975852920947*^9, {
   3.89450087923026*^9, 3.8945008936657877`*^9}, 3.894685530632435*^9, 
   3.895039871910738*^9, 3.8952698745775747`*^9, 3.8955425546416187`*^9, 
   3.895716109980179*^9, 3.89580061845199*^9, 3.895885755318775*^9, 
   3.89605066822718*^9, 3.896949552605785*^9, 3.897697524772636*^9},
 CellLabel->
  "During evaluation of \
In[5]:=",ExpressionUUID->"bacccb1c-04cb-4ab2-8a98-00606d7e20c8"],

Cell[BoxData["\<\"V declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.857017258021285*^9, 3.857205455995563*^9, 3.8574479786122217`*^9, 
   3.857449026567123*^9, 3.857450053296307*^9, 3.858654105129344*^9, 
   3.859348922277046*^9, 3.859452101079454*^9, 3.859713337485505*^9, 
   3.86013749105093*^9, 3.860555719961184*^9, 3.860629326098345*^9, 
   3.860844158728386*^9, 3.861081536028767*^9, 3.861262791601131*^9, 
   3.8615005249145308`*^9, 3.869648866248951*^9, 3.869649217071579*^9, 
   3.870066690323264*^9, 3.870150190777561*^9, 3.870152342640258*^9, 
   3.8701534202589808`*^9, 3.870236122409807*^9, 3.8702549083942337`*^9, 
   3.870260364806555*^9, 3.870401766898699*^9, 3.8704020123375387`*^9, 
   3.870494349798994*^9, 3.87059014524513*^9, 3.870652011749073*^9, 
   3.870654963278955*^9, 3.870674576138321*^9, 3.870743062886133*^9, 
   3.870819879887828*^9, 3.870829357322528*^9, 3.8709317613543777`*^9, 
   3.871011277711314*^9, 3.871012863768826*^9, 3.871168338208912*^9, 
   3.871184492077347*^9, 3.871185617354723*^9, 3.8712055200529346`*^9, {
   3.87129726065751*^9, 3.871297268011313*^9}, 3.871304062246093*^9, 
   3.8716194298578444`*^9, 3.871621513244425*^9, 3.871689433507557*^9, 
   3.8717884381507473`*^9, 3.8717946268623123`*^9, 3.871881006486046*^9, 
   3.871972611380741*^9, 3.871982606053879*^9, 3.872033438356305*^9, 
   3.872072739458227*^9, 3.872118638192325*^9, 3.8721432436469183`*^9, 
   3.872206866116229*^9, 3.872208727857349*^9, 3.872224824689538*^9, 
   3.872294569501293*^9, 3.872305263153335*^9, 3.875348925687496*^9, 
   3.875938480412423*^9, 3.876366759630951*^9, 3.8764526041903133`*^9, 
   3.8766114463684177`*^9, 3.876777454764464*^9, 3.876873445731583*^9, 
   3.876874700381797*^9, 3.876886864903775*^9, 3.876970198753796*^9, 
   3.884923311143351*^9, 3.884931941221653*^9, 3.885602032461825*^9, 
   3.888032284103799*^9, 3.888032590031375*^9, 3.888274329041766*^9, 
   3.888888776901124*^9, 3.891309551005546*^9, 3.891340391081622*^9, 
   3.891340584196597*^9, 3.892085072467169*^9, 3.893975852920947*^9, {
   3.89450087923026*^9, 3.8945008936657877`*^9}, 3.894685530632435*^9, 
   3.895039871910738*^9, 3.8952698745775747`*^9, 3.8955425546416187`*^9, 
   3.895716109980179*^9, 3.89580061845199*^9, 3.895885755318775*^9, 
   3.89605066822718*^9, 3.896949552605785*^9, 3.897697524775002*^9},
 CellLabel->
  "During evaluation of \
In[5]:=",ExpressionUUID->"fba54c61-d39c-4c54-9a72-021755995418"],

Cell[BoxData["\<\"S declared as a 4-dimensional rank-2 tensor header.\"\>"], \
"Print",
 CellChangeTimes->{
  3.852705423445962*^9, 3.853201928554336*^9, 3.853231965452387*^9, 
   3.85337187136558*^9, 3.853459812005756*^9, 3.853460204922298*^9, 
   3.853460669680669*^9, 3.8534768757258263`*^9, 3.854165620222087*^9, 
   3.8544282192529*^9, 3.854584759015489*^9, 3.854776837385623*^9, 
   3.8550282418140087`*^9, 3.855293113115707*^9, 3.85564157940452*^9, 
   3.8556653542587233`*^9, 3.8563167306064*^9, 3.856397724272987*^9, 
   3.857017258021285*^9, 3.857205455995563*^9, 3.8574479786122217`*^9, 
   3.857449026567123*^9, 3.857450053296307*^9, 3.858654105129344*^9, 
   3.859348922277046*^9, 3.859452101079454*^9, 3.859713337485505*^9, 
   3.86013749105093*^9, 3.860555719961184*^9, 3.860629326098345*^9, 
   3.860844158728386*^9, 3.861081536028767*^9, 3.861262791601131*^9, 
   3.8615005249145308`*^9, 3.869648866248951*^9, 3.869649217071579*^9, 
   3.870066690323264*^9, 3.870150190777561*^9, 3.870152342640258*^9, 
   3.8701534202589808`*^9, 3.870236122409807*^9, 3.8702549083942337`*^9, 
   3.870260364806555*^9, 3.870401766898699*^9, 3.8704020123375387`*^9, 
   3.870494349798994*^9, 3.87059014524513*^9, 3.870652011749073*^9, 
   3.870654963278955*^9, 3.870674576138321*^9, 3.870743062886133*^9, 
   3.870819879887828*^9, 3.870829357322528*^9, 3.8709317613543777`*^9, 
   3.871011277711314*^9, 3.871012863768826*^9, 3.871168338208912*^9, 
   3.871184492077347*^9, 3.871185617354723*^9, 3.8712055200529346`*^9, {
   3.87129726065751*^9, 3.871297268011313*^9}, 3.871304062246093*^9, 
   3.8716194298578444`*^9, 3.871621513244425*^9, 3.871689433507557*^9, 
   3.8717884381507473`*^9, 3.8717946268623123`*^9, 3.871881006486046*^9, 
   3.871972611380741*^9, 3.871982606053879*^9, 3.872033438356305*^9, 
   3.872072739458227*^9, 3.872118638192325*^9, 3.8721432436469183`*^9, 
   3.872206866116229*^9, 3.872208727857349*^9, 3.872224824689538*^9, 
   3.872294569501293*^9, 3.872305263153335*^9, 3.875348925687496*^9, 
   3.875938480412423*^9, 3.876366759630951*^9, 3.8764526041903133`*^9, 
   3.8766114463684177`*^9, 3.876777454764464*^9, 3.876873445731583*^9, 
   3.876874700381797*^9, 3.876886864903775*^9, 3.876970198753796*^9, 
   3.884923311143351*^9, 3.884931941221653*^9, 3.885602032461825*^9, 
   3.888032284103799*^9, 3.888032590031375*^9, 3.888274329041766*^9, 
   3.888888776901124*^9, 3.891309551005546*^9, 3.891340391081622*^9, 
   3.891340584196597*^9, 3.892085072467169*^9, 3.893975852920947*^9, {
   3.89450087923026*^9, 3.8945008936657877`*^9}, 3.894685530632435*^9, 
   3.895039871910738*^9, 3.8952698745775747`*^9, 3.8955425546416187`*^9, 
   3.895716109980179*^9, 3.89580061845199*^9, 3.895885755318775*^9, 
   3.89605066822718*^9, 3.896949552605785*^9, 3.897697524777582*^9},
 CellLabel->
  "During evaluation of \
In[5]:=",ExpressionUUID->"1b057549-b2db-4e6b-814d-2ca2a4a2d8ed"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["SubFunctions", "Section",
 CellChangeTimes->{{3.810011820953319*^9, 
  3.810011824102497*^9}},ExpressionUUID->"9c1ce1b6-b8bc-4a62-a2fc-\
094d40b4da22"],

Cell[CellGroupData[{

Cell["general functions", "Subsection",
 CellChangeTimes->{{3.8717162484953003`*^9, 
  3.8717162609396152`*^9}},ExpressionUUID->"d2f29554-df37-4996-aba1-\
a5345b3b87ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nicevs", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", "i_", "]"}], ":>", 
        SubscriptBox["v", "i"]}], ",", 
       RowBox[{
        RowBox[{"S", "[", "i_", "]"}], ":>", 
        SubscriptBox["S", "i"]}], ",", 
       RowBox[{
        RowBox[{"c", "[", "i_", "]"}], ":>", 
        SubscriptBox["c", "i"]}], ",", 
       RowBox[{
        RowBox[{"a", "[", "i_", "]"}], ":>", 
        SubscriptBox["a", "i"]}], ",", 
       RowBox[{
        RowBox[{"w", "[", "i__", "]"}], ":>", 
        SubscriptBox["w", "i"]}], ",", 
       RowBox[{
        RowBox[{"pm", "[", "i_", "]"}], ":>", 
        SubscriptBox["pm", "i"]}]}], "}"}], ",", "nice"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.877388939506537*^9, 3.877388949032188*^9}, {
   3.8786378572270403`*^9, 3.878637863818118*^9}, 3.879642703271042*^9, {
   3.879643012238213*^9, 3.879643012690983*^9}, {3.879645027363619*^9, 
   3.8796450276094027`*^9}, {3.8796452459785624`*^9, 3.879645256091978*^9}, {
   3.884942774796582*^9, 3.884942812258222*^9}, {3.884943575812697*^9, 
   3.884943576388833*^9}, {3.897091443836419*^9, 3.897091474385048*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"e20cbbf1-1cdc-4f4d-82ed-9b882eff559a"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"SimplifyMono", ",", "SimplifyMonof"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyMono", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", "=", 
      RowBox[{"f", "//", "Expand"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "res", "]"}], "===", "Plus"}], ",", 
       RowBox[{"res", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@@", "res"}], ")"}], "//", "Simplify"}], "//", 
         "Total"}]}], ",", 
       RowBox[{"res", "=", 
        RowBox[{"Simplify", "[", "res", "]"}]}]}], "]"}], ";", "res"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SimplifyMonof", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", "=", 
      RowBox[{"f", "//", "Expand"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", "res", "]"}], "===", "Plus"}], ",", 
       RowBox[{"res", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@@", "res"}], ")"}], "//", "Simplify"}], "//", 
         "Total"}]}], ",", 
       RowBox[{"res", "=", 
        RowBox[{"FullSimplify", "[", "res", "]"}]}]}], "]"}], ";", "res"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.871038879132368*^9, 3.871038905309572*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"cfa2a526-03ef-4db7-81fa-be6f0870607b"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Collectj", ",", "Collectjf"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Collectj", ":=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"j", "[", "__", "]"}], ",", "Simplify"}], "]"}], 
   "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"Collectjf", ":=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"j", "[", "__", "]"}], ",", "FullSimplify"}], "]"}], 
   "&"}]}]}], "Input",
 CellChangeTimes->{{3.870563255866166*^9, 3.870563259484146*^9}, {
   3.870655391967127*^9, 3.87065539655599*^9}, 3.870655469270833*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"b30e5d1f-7ea2-415b-bd9b-f1cbf4f09379"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Collectb", ",", "Collectbf"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Collectb", ":=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"B", "[", "__", "]"}]}], "]"}], "&"}]}], "\[IndentingNewLine]", 
 RowBox[{"Collectbf", ":=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{"#", ",", 
     RowBox[{"B", "[", "__", "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Factor", "[", "#1", "]"}], "//", "FullSimplify"}], ")"}], 
      "&"}]}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.8705913651404657`*^9, 3.870591383682583*^9}, 
   3.870655472075412*^9, {3.870655517557816*^9, 3.870655550957642*^9}, {
   3.876611424237235*^9, 3.876611424429071*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"e807e768-058e-43ae-9999-626bd35535d4"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Casesdot", ",", "CasesG"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Casesdot", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Cases", "[", 
    RowBox[{"f", ",", 
     RowBox[{"dot", "[", "__", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", 
   "Union"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CasesG", "[", "f_", "]"}], ":=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"f", ",", 
       RowBox[{"G", "[", "__", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}], 
    ",", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"f", ",", 
       RowBox[{"Gp", "[", "__", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", "Union"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.871860800284142*^9, 3.871860849326124*^9}, {
   3.871860880863056*^9, 3.8718609082263327`*^9}, 3.872119829251048*^9, {
   3.886564859254897*^9, 3.886564872086482*^9}, {3.886567746189926*^9, 
   3.886567766222451*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"742dd0b6-2e1b-4725-996c-49a833641153"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", 
   RowBox[{"replace", ",", "replaceGen"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"replace", "[", 
    RowBox[{"otherDDMOrder_", ",", "n_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"n", "-", "1"}], "]"}]}], ")"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
      RowBox[{"otherDDMOrder", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"replace", "[", "otherDDMOrder_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gg", ",", "ggod"}], "}"}], ",", 
    RowBox[{
     RowBox[{"gg", "=", 
      RowBox[{"p", "/@", "otherDDMOrder"}]}], ";", 
     RowBox[{"ggod", "=", 
      RowBox[{"Sort", "[", "gg", "]"}]}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", "ggod", ")"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
        RowBox[{
         RowBox[{"(", "gg", ")"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "gg"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"replaceGen", "[", 
   RowBox[{"a_", ",", "otherDDMOrder__"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gg", ",", "ggod"}], "}"}], ",", 
    RowBox[{
     RowBox[{"gg", "=", 
      RowBox[{"a", "/@", 
       RowBox[{"{", "otherDDMOrder", "}"}]}]}], ";", 
     RowBox[{"ggod", "=", 
      RowBox[{"Sort", "[", "gg", "]"}]}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", "ggod", ")"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", " ", 
        RowBox[{
         RowBox[{"(", "gg", ")"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "gg"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.853809980519072*^9, 3.8538099861376333`*^9}, {
  3.879635708653821*^9, 3.8796357521749907`*^9}, {3.879635782978458*^9, 
  3.879635786944889*^9}, {3.879635851991856*^9, 3.8796358971405983`*^9}, {
  3.879636430440351*^9, 3.879636476783681*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"87bd1bab-44c2-412b-ba82-9f40eb6040fe"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "repPrepared", "]"}], "\[IndentingNewLine]", 
 RowBox[{"repPrepared", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", "i_", "]"}], ":>", 
     RowBox[{"F", "[", 
      RowBox[{"p", "[", "i", "]"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"w", "[", "i_", "]"}], ":>", 
     RowBox[{"w", "[", 
      RowBox[{"p", "[", "i", "]"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"p", "[", "j__", "]"}], ":>", 
     RowBox[{"p", "@@", 
      RowBox[{"(", 
       RowBox[{"p", "/@", 
        RowBox[{"{", "j", "}"}]}], ")"}]}]}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.880168137092037*^9, 3.880168159180973*^9}, {
  3.880168234772587*^9, 3.880168236400927*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"305a12e0-d3f9-47a6-890e-663c1dc473f0"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"dotOnshell", ",", "vonshell"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"dotOnshell", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"v", "[", "i_", "]"}], ",", 
       RowBox[{"v", "[", "i_", "]"}]}], "]"}], ":>", "1"}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"v", "[", "1", "]"}], ",", 
       RowBox[{"a", "[", "1", "]"}]}], "]"}], "->", "0"}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", "i_", "]"}]}], "]"}], ":>", "0"}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "i_", "]"}], ",", 
       RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":>", "0"}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "i_", "]"}], ",", 
       RowBox[{"\[Epsilon]", "[", "i_", "]"}]}], "]"}], ":>", "0"}], ",", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"p", "[", "2", "]"}], ",", 
       RowBox[{"v", "[", "1", "]"}]}], "]"}], ":>", " ", 
     RowBox[{"-", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "1", "]"}], ",", 
        RowBox[{"v", "[", "1", "]"}]}], "]"}]}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vonshell", "[", 
   RowBox[{"n_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"v", ",", 
      RowBox[{"p", "[", "i", "]"}]}], "]"}], "\[RuleDelayed]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"v", ",", 
        RowBox[{"p", "[", "i", "]"}]}], "]"}], "-", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"v", ",", 
          RowBox[{"p", "[", "j", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], ")"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"onshell", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"dot", "[", 
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"n", "-", "2"}], "]"}], ",", 
     RowBox[{"p", "[", 
      RowBox[{"n", "-", "1"}], "]"}]}], "]"}], "\[Rule]", "  ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Total", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "i", "]"}], ",", 
             RowBox[{"p", "[", "j", "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"j", "-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], "//", "Flatten"}], 
      "]"}]}], "+", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"n", "-", "2"}], "]"}], ",", 
      RowBox[{"p", "[", 
       RowBox[{"n", "-", "1"}], "]"}]}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.727163684521564*^9, 3.727163712580194*^9}, 
   3.728198771127473*^9, {3.7282976424483356`*^9, 3.728297678974709*^9}, {
   3.728297723296649*^9, 3.72829773196879*^9}, {3.7492963246076107`*^9, 
   3.749296346599493*^9}, {3.7492969402526007`*^9, 3.749296945367785*^9}, {
   3.756962173926325*^9, 3.756962173952697*^9}, {3.756962214008494*^9, 
   3.756962214036718*^9}, {3.756962285466909*^9, 3.7569622869241734`*^9}, {
   3.756970904201673*^9, 3.7569709322363663`*^9}, {3.759113304523664*^9, 
   3.759113331527665*^9}, {3.759113382631379*^9, 3.759113498024493*^9}, {
   3.759592650632361*^9, 3.759592657996381*^9}, {3.810004273599478*^9, 
   3.8100042908157053`*^9}, {3.813368130768548*^9, 3.813368161218802*^9}, {
   3.8133682014741793`*^9, 3.813368212397605*^9}, {3.813542982230701*^9, 
   3.813543013179331*^9}, {3.813546153285891*^9, 3.813546158120234*^9}, {
   3.813546308456645*^9, 3.8135463101535473`*^9}, {3.8135464926562147`*^9, 
   3.813546546885747*^9}, 3.813546667616501*^9, {3.813547074493762*^9, 
   3.8135470808592043`*^9}, {3.813547399867567*^9, 3.813547441608583*^9}, {
   3.813559656501801*^9, 3.813559667068569*^9}, {3.8135597068041677`*^9, 
   3.813559710282649*^9}, {3.813559768037219*^9, 3.813559779622561*^9}, {
   3.813560124477251*^9, 3.813560131135003*^9}, {3.813560238138142*^9, 
   3.813560266973859*^9}, {3.813560313088909*^9, 3.81356032625429*^9}, {
   3.8135603625794773`*^9, 3.813560379883116*^9}, {3.813562756751007*^9, 
   3.8135627570797586`*^9}, 3.813587217305232*^9, {3.813631538481387*^9, 
   3.813631541035822*^9}, {3.8136340222518473`*^9, 3.813634050518487*^9}, {
   3.843431280830508*^9, 3.843431302343697*^9}, {3.843553240936262*^9, 
   3.8435532494635687`*^9}, {3.843553679143483*^9, 3.843553679792428*^9}, {
   3.843553831340781*^9, 3.843553834894973*^9}, {3.879644003724228*^9, 
   3.8796440660759573`*^9}, 3.891310557983914*^9, {3.891310588348125*^9, 
   3.89131058913111*^9}, {3.891310742294742*^9, 3.8913107429055233`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"b5cef998-9b4b-4c67-a773-8da59589aa26"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "onshellcut", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"onshellcut", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"dotOnshell", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", 
        RowBox[{"-", "2"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "i_", "]"}], ",", 
         RowBox[{"v", "[", "1", "]"}]}], "]"}], ":>", "0"}], "}"}]}], "]"}]}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.891310485450725*^9, 3.891310493577715*^9}, {
  3.891310526778987*^9, 3.891310527259301*^9}, {3.891310592818289*^9, 
  3.891310616337873*^9}, {3.891310805233571*^9, 3.8913108107361803`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"287347e7-7a20-4c83-96c2-dc5d1d51baf6"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"sortP", ",", "sortE"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortP", "[", 
   RowBox[{"li_", ",", "lr_"}], "]"}], ":=", 
  RowBox[{"SortBy", "[", 
   RowBox[{"li", ",", " ", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"lr", ",", 
       RowBox[{"(", 
        RowBox[{"First", "@", "#"}], ")"}]}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sortE", "[", 
   RowBox[{"li_", ",", "lr_"}], "]"}], ":=", 
  RowBox[{"SortBy", "[", 
   RowBox[{"li", ",", " ", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"lr", ",", 
       RowBox[{"(", 
        RowBox[{"First", "@@", "#"}], ")"}]}], "]"}], "&"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "repBack", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"repBack", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"a_", ",", "i_"}], "]"}], ":>", " ", 
      RowBox[{"a", "[", "i", "]"}]}], ",", 
     RowBox[{"CenterDot", "->", " ", "dot"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.727163681618944*^9, {3.749179480748872*^9, 3.749179491659102*^9}, {
   3.749296395909049*^9, 3.7492964230074463`*^9}, {3.74929688390792*^9, 
   3.74929689475134*^9}, 3.756962173957769*^9, 3.7569622140447397`*^9, {
   3.756962309850726*^9, 3.7569623219178553`*^9}, {3.75697119019627*^9, 
   3.756971194962592*^9}, {3.810006123538918*^9, 3.810006130187482*^9}, {
   3.813643784231852*^9, 3.813643813331348*^9}, 3.841472859500243*^9, {
   3.851849638478299*^9, 3.851849659664133*^9}, {3.854063182750596*^9, 
   3.854063189346609*^9}, 3.879636523684457*^9, {3.879643062374737*^9, 
   3.8796430697726297`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"ea7c9f1f-dd9a-4055-bf49-793acbc051ab"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"cyclePermute", ",", "cyclePermuteSum"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyclePermute", "[", "n_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "list", "}"}], ",", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{"Permute", "[", " ", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ",", " ", 
        RowBox[{"Cycles", "[", 
         RowBox[{"{", 
          RowBox[{"Table", "[", 
           RowBox[{"i", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "]"}], "}"}], "]"}]}], "]"}]}],
      ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Rule", "[", 
        RowBox[{
         RowBox[{"p", "[", "i", "]"}], ",", 
         RowBox[{"list", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cyclePermuteSum", "[", 
   RowBox[{"f_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fsum", ",", 
      RowBox[{"g", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", "f"}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", 
          RowBox[{"i", "+", "1"}], "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/.", 
         RowBox[{"cyclePermute", "[", "n", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ";", " ", 
     RowBox[{"fsum", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{3.7595925973087378`*^9},
 CellLabel->"In[40]:=",ExpressionUUID->"93a97d95-a81d-46ff-a4cf-cc841727e0d3"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"leadingSeries", ",", "LdTerm"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"leadingSeries", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "x0_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Normal", "[", 
   RowBox[{
    RowBox[{"expr", "/.", 
     RowBox[{"x", "\[Rule]", 
      RowBox[{"Series", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "x0", ",", "1"}], "}"}]}], "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{
      RowBox[{"Verbatim", "[", "SeriesData", "]"}], "[", 
      RowBox[{"a__", ",", 
       RowBox[{"{", 
        RowBox[{"b_", ",", "___"}], "}"}], ",", "c__"}], "]"}], 
     "\[RuleDelayed]", 
     RowBox[{"SeriesData", "[", 
      RowBox[{"a", ",", 
       RowBox[{"{", "b", "}"}], ",", "c"}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"LdTerm", "[", 
   RowBox[{"f_", ",", "var_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"leadingSeries", "[", 
    RowBox[{"f", ",", 
     RowBox[{"{", 
      RowBox[{"var", ",", "\[Infinity]"}], "}"}]}], "]"}], "//", 
   "Normal"}]}]}], "Input",
 CellLabel->"In[43]:=",ExpressionUUID->"2ea36659-f845-4524-a46d-b556cd85234b"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "coef", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coef", "[", 
   RowBox[{"h_", ",", "mono_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Cases", "[", 
    RowBox[{"h", ",", 
     RowBox[{
      RowBox[{"Times", "[", 
       RowBox[{"f___", ",", "mono", ",", "g___"}], "]"}], ":>", 
      RowBox[{"Times", "[", 
       RowBox[{"f", ",", "g"}], "]"}]}]}], "]"}], "//", "Total"}]}]}], "Input",\

 CellChangeTimes->{3.891313330047256*^9},
 CellLabel->"In[46]:=",ExpressionUUID->"ebfbc6e8-f5f7-42bd-a900-43d5498f6814"]
}, Closed]],

Cell[CellGroupData[{

Cell["Expand Tensors", "Subsection",
 CellChangeTimes->{{3.871715923985506*^9, 
  3.8717159306720257`*^9}},ExpressionUUID->"73b7480f-a370-4824-9379-\
1e4ba8a3fd1c"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"expandTdot", ",", "expandT"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTdot", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"f", "/.", 
        RowBox[{
         RowBox[{"dot", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
         RowBox[{"expandTensor", "[", 
          RowBox[{"dot", "[", "g", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{
         RowBox[{"F", "[", "i_", "]"}], "[", 
         RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], "[", "a", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "i", "]"}], "[", "b", "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "i", "]"}], "[", "a", "]"}], 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], "[", "b", "]"}]}]}]}]}], "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"W", "[", "i_", "]"}], "[", 
        RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], "[", "a", "]"}], 
         RowBox[{
          RowBox[{"v", "[", "i", "]"}], "[", "b", "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", "i", "]"}], "[", "a", "]"}], 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], "[", "b", "]"}]}]}]}]}], "/.", 
     RowBox[{
      RowBox[{
       RowBox[{"V", "[", "i___", "]"}], "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", "0", "]"}], "[", "a", "]"}], 
       RowBox[{
        RowBox[{"p", "[", "i", "]"}], "[", "b", "]"}]}]}]}], ")"}], "//", 
   "contract"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandT", "[", "f_", "]"}], ":=", " ", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", "g___", "]"}], "\[RuleDelayed]", " ", 
    RowBox[{"expandTdot", "[", 
     RowBox[{"dot", "[", "g", "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"expandTensorGen", ",", "expandF"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTensorGen", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"f", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", "nn_"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"DC", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"dot", "[", "g", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "nn"}], "}"}]}], "]"}]}], "/;", 
           RowBox[{"nn", ">", "0"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g", "]"}], ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"g", ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h", "]"}], ",", "g"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"h", ",", "g"}], "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"res", "/.", 
        RowBox[{
         RowBox[{"dot", "[", "g__", "]"}], ":>", 
         RowBox[{"expandTensor", "[", 
          RowBox[{"dot", "[", "g", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"DC", "[", "g__", "]"}], ":>", 
        RowBox[{"DC", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "g", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"lI", "[", "ids__", "]"}], ":>", 
             RowBox[{"lI", "[", 
              RowBox[{"ii", ",", "ids"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"{", "g", "}"}]}]}], "}"}]}], "]"}]}]}]}], "/.", 
      RowBox[{"DC", "->", "Times"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandF", "[", 
   RowBox[{"f_", ",", "id_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", "id", "]"}], "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", "id", "]"}], "[", "a", "]"}], 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", "b", "]"}]}], "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", "a", "]"}], 
      RowBox[{
       RowBox[{"p", "[", "id", "]"}], "[", "b", 
       "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandF", "[", "f_", "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{
     RowBox[{"F", "[", "id_", "]"}], "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", "id", "]"}], "[", "a", "]"}], 
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", "b", "]"}]}], "-", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", "a", "]"}], 
      RowBox[{
       RowBox[{"p", "[", "id", "]"}], "[", "b", "]"}]}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8519988490005493`*^9, 3.8519988586312313`*^9}, {
  3.852266080976235*^9, 3.852266083544794*^9}, {3.8522661271732883`*^9, 
  3.8522661315239162`*^9}, {3.8522662312904997`*^9, 3.8522662509717417`*^9}, {
  3.852342321299981*^9, 3.852342321961708*^9}, {3.852342379535592*^9, 
  3.852342380584991*^9}, {3.871691418979636*^9, 3.871691419907322*^9}, {
  3.87169145976577*^9, 3.871691475455221*^9}, {3.871691506816244*^9, 
  3.8716916564787827`*^9}, {3.871691706084654*^9, 3.871691733103662*^9}, {
  3.8717067770260687`*^9, 3.871706787951022*^9}, {3.871706897332698*^9, 
  3.871706919266697*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"41043e5a-5d19-4d2a-af02-09fa94f97da7"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandFDirect", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandFDirect", "[", 
   RowBox[{"f_", ",", "id_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "id", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"p", "[", "id", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "b"}], "]"}]}], "-", " ", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "id", "]"}], ",", "b"}], 
       "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandFDirect", "[", "f_", "]"}], ":=", 
  RowBox[{"f", "//.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "id_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"p", "[", "id", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "b"}], "]"}]}], "-", " ", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "id", "]"}], ",", "b"}], "]"}]}]}]}]}]}]}], "Input",\

 CellChangeTimes->{{3.876777766242668*^9, 3.87677794338896*^9}, {
  3.895741805970068*^9, 3.895741808300335*^9}, {3.895741899210198*^9, 
  3.895741900776535*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"c577fd7b-c851-4cd8-a400-9809d2d19cf2"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "dressdot", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dressdot", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{"res", "=", 
     RowBox[{
      RowBox[{"f", "/.", 
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"g_", ",", 
          RowBox[{"\[Epsilon]", "[", "id_", "]"}]}], "]"}], ":>", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"lI", "[", 
           RowBox[{"0", ",", "id"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"0", ",", "id"}], "]"}], "]"}]}]}]}], "/.", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "id_", "]"}], ",", "g_"}], "]"}], ":>", 
       RowBox[{
        RowBox[{"g", "[", 
         RowBox[{"lI", "[", 
          RowBox[{"0", ",", "id"}], "]"}], "]"}], 
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"0", ",", "id"}], "]"}], "]"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "dressdotGen", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dressdotGen", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"f", "//", "Expand"}]}], ";", 
     RowBox[{"res", "=", 
      RowBox[{"res", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", "nn_"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"DC", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"dot", "[", "g", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "nn"}], "}"}]}], "]"}]}], "/;", 
           RowBox[{"nn", ">", "0"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g", "]"}], ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"g", ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h", "]"}], ",", "g"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"h", ",", "g"}], "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "//", "dressdot"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "/.", 
       RowBox[{
        RowBox[{"DC", "[", "g__", "]"}], ":>", 
        RowBox[{"DC", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "g", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"lI", "[", "ids__", "]"}], ":>", 
             RowBox[{"lI", "[", 
              RowBox[{"ii", ",", "ids"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"{", "g", "}"}]}]}], "}"}]}], "]"}]}]}]}], "/.", 
      RowBox[{"DC", "->", "Times"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{
  3.872034945418346*^9, {3.8720349907917633`*^9, 3.872034993209223*^9}, {
   3.872036261541153*^9, 3.872036291395546*^9}, {3.872036858716271*^9, 
   3.872036870110409*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"101282f6-ddf7-4c34-b35b-ecbb54c60d3b"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandGen", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandGen", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"f", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", "nn_"}], "]"}], ":>", 
          RowBox[{
           RowBox[{"DC", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"dot", "[", "g", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "nn"}], "}"}]}], "]"}]}], "/;", 
           RowBox[{"nn", ">", "0"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "g", "]"}], ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "g__", "]"}], ",", 
            RowBox[{"dot", "[", "h__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"g", ",", 
            RowBox[{"dot", "[", "h", "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", "h", "]"}], ",", "g"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"DC", "[", "h__", "]"}], ",", 
            RowBox[{"DC", "[", "g__", "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{"h", ",", "g"}], "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "//", "dressdot"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"res", "/.", 
        RowBox[{
         RowBox[{"dot", "[", "g__", "]"}], ":>", 
         RowBox[{"expandTensor", "[", 
          RowBox[{"dot", "[", "g", "]"}], "]"}]}]}], "/.", 
       RowBox[{
        RowBox[{"DC", "[", "g__", "]"}], ":>", 
        RowBox[{"DC", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "g", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"lI", "[", "ids__", "]"}], ":>", 
             RowBox[{"lI", "[", 
              RowBox[{"ii", ",", "ids"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"{", "g", "}"}]}]}], "}"}]}], "]"}]}]}]}], "/.", 
      RowBox[{"DC", "->", "Times"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.872034492365653*^9, 3.872034567286909*^9}, {
  3.8720347035629787`*^9, 3.872034758097516*^9}, {3.8720350050883617`*^9, 
  3.87203501817365*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"c42f75c8-120b-48db-bbf0-433b064efe67"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "FTensorReduce", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTensorReduce", "[", "f_", "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "i_", "]"}], ",", "b__"}], "]"}], ":>", " ", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "2", "]"}], ",", 
         RowBox[{"p", "[", "i", "]"}]}], "]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", 
           RowBox[{"v", "[", "2", "]"}]}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", "b"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"v", "[", "2", "]"}], ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "b"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"p", "[", "i", "]"}]}], "]"}]}]}], ")"}]}], "/;", 
     RowBox[{"b", "=!=", 
      RowBox[{"v", "[", "2", "]"}]}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTensorReduce", "[", 
   RowBox[{"f_", ",", "v2_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "i_", "]"}], ",", "b__"}], "]"}], ":>", " ", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"dot", "[", 
        RowBox[{"v2", ",", 
         RowBox[{"p", "[", "i", "]"}]}], "]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "v2"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", "b"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"v2", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "b"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"p", "[", "i", "]"}]}], "]"}]}]}], ")"}]}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"b", "=!=", "v2"}], "&&", 
       RowBox[{"a", "=!=", "v2"}]}], ")"}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8710113197696133`*^9, 3.8710113205510817`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"2adab730-0fcf-4c5a-a80b-c851d9614d46"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "FTensorReduceG", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FTensorReduceG", "[", 
   RowBox[{"f_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"f", "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "i", "]"}], ",", "b__"}], "]"}], ":>", " ", 
    RowBox[{
     RowBox[{
      FractionBox["1", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"v", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "i", "]"}]}], "]"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", 
           RowBox[{"v", "[", "1", "]"}]}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", "b"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"v", "[", "1", "]"}], ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "b"}], "]"}], 
         RowBox[{"dot", "[", 
          RowBox[{"a", ",", 
           RowBox[{"p", "[", "i", "]"}]}], "]"}]}]}], ")"}]}], "/;", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "a", "}"}], "]"}], ">=", "2"}], "&&", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"{", "b", "}"}], "]"}], ">=", "2"}]}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8766049144819403`*^9, 3.8766049514374*^9}, {
  3.884942023646875*^9, 3.8849420276716413`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"5936a091-d150-4130-84a8-31c559d8a8d6"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandTr", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTr", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lt", "=", 
         RowBox[{"Length", "[", "f", "]"}]}], ",", "ts"}], "}"}], ",", 
      RowBox[{"ts", "=", 
       RowBox[{"f", "/.", 
        RowBox[{
         RowBox[{"tr", "[", "g___", "]"}], ":>", " ", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"lI", "[", 
            RowBox[{"0", ",", "1"}], "]"}], ",", "g", ",", 
           RowBox[{"lI", "[", 
            RowBox[{"0", ",", "1"}], "]"}]}], "]"}]}]}]}]}], "]"}], "//", 
    "expandGen"}], "//", "expandF"}]}]}], "Input",
 CellChangeTimes->{{3.854191039354165*^9, 3.854191039594904*^9}, {
  3.854191096585668*^9, 3.8541911346819267`*^9}, {3.854191258960875*^9, 
  3.8541912891639442`*^9}, {3.854191345530801*^9, 3.8541913487274323`*^9}, {
  3.8541914272027063`*^9, 3.854191501571187*^9}, {3.854191759253392*^9, 
  3.8541917851217737`*^9}, {3.8541918354435787`*^9, 3.854191903651122*^9}, {
  3.8541921068331747`*^9, 3.854192117283308*^9}, {3.8765378395707912`*^9, 
  3.876537841794339*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"5d1c4dbf-4db1-411d-9eb2-91f10d2e4065"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "tr2dot", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tr2dot", "[", "f_tr", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"last", ",", "vlist", ",", "plast", ",", "v1", ",", "v2"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"last", "=", 
      RowBox[{"f", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", 
     RowBox[{"plast", "=", 
      RowBox[{"p", "@@", "last"}]}], ";", 
     RowBox[{"vlist", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"List", "@@", "f"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v1", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "plast", "}"}], ",", "vlist", ",", 
        RowBox[{"{", "last", "}"}], ",", 
        RowBox[{"{", "v", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v2", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "v", "}"}], ",", 
        RowBox[{"{", "last", "}"}], ",", "vlist", ",", 
        RowBox[{"{", "plast", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       RowBox[{"dot", "@@", "v1"}], 
       RowBox[{"dot", "[", 
        RowBox[{"v", ",", "plast"}], "]"}]], "+", 
      FractionBox[
       RowBox[{"dot", "@@", "v2"}], 
       RowBox[{"dot", "[", 
        RowBox[{"v", ",", "plast"}], "]"}]]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tr2dot", "[", 
   RowBox[{"f_tr", ",", "a_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"last", ",", "vlist", ",", "plast", ",", "v1", ",", "v2"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"last", "=", 
      RowBox[{"f", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", 
     RowBox[{"plast", "=", 
      RowBox[{"p", "@@", "last"}]}], ";", 
     RowBox[{"vlist", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"List", "@@", "f"}], ")"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", 
         RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v1", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "plast", "}"}], ",", "vlist", ",", 
        RowBox[{"{", "last", "}"}], ",", 
        RowBox[{"{", "a", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v2", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "a", "}"}], ",", 
        RowBox[{"{", "last", "}"}], ",", "vlist", ",", 
        RowBox[{"{", "plast", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      FractionBox[
       RowBox[{"dot", "@@", "v1"}], 
       RowBox[{"dot", "[", 
        RowBox[{"a", ",", "plast"}], "]"}]], "+", 
      FractionBox[
       RowBox[{"dot", "@@", "v2"}], 
       RowBox[{"dot", "[", 
        RowBox[{"a", ",", "plast"}], "]"}]]}]}]}], "]"}]}]}], "Input",
 CellLabel->"In[71]:=",ExpressionUUID->"be8084ef-54f7-48de-90e1-cb41967ce54b"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "antiSymrep", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"antiSymrep", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "b_"}], "]"}], ":>", " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{"b", ",", 
          RowBox[{"F", "[", "i", "]"}], ",", "a"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"Signature", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "<", "0"}]}]}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", 
        RowBox[{"F", "[", "j_", "]"}], ",", "b_"}], "]"}], ":>", " ", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"b", ",", 
         RowBox[{"F", "[", "j", "]"}], ",", 
         RowBox[{"F", "[", "i", "]"}], ",", "a"}], "]"}], "/;", 
       RowBox[{"i", ">", "j"}]}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.853462108697447*^9, 3.853462142837044*^9}, {
  3.8534646323189697`*^9, 3.8534646409716263`*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"cfbe45c5-f9c8-4198-8910-2ad2f83921b4"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "CombWithRep", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CombWithRep", "[", 
   RowBox[{"ls_", ",", "n_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"List", "@@", 
     RowBox[{"(", 
      RowBox[{"Diamond", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Total", "[", "ls", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ")"}]}], ")"}], "/.", 
   RowBox[{"Diamond", "->", " ", "List"}]}]}]}], "Input",
 CellLabel->"In[76]:=",ExpressionUUID->"4d2ef866-ff12-48be-a749-98a60647b861"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "minSets", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"minSets", "[", "list_List", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "=", 
       RowBox[{"Union", "@", "list"}]}], ",", "r"}], "}"}], ",", 
    RowBox[{"Pick", "[", 
     RowBox[{"u", ",", 
      RowBox[{"Subtract", "[", 
       RowBox[{
        RowBox[{"BitAnd", "@@@", 
         RowBox[{"Replace", "[", 
          RowBox[{"u", ",", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"g", "=", 
               RowBox[{"GatherBy", "[", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Join", "@@", "u"}], ",", 
                    RowBox[{"Join", "@@", 
                    RowBox[{"MapThread", "[", 
                    RowBox[{"ConstantArray", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r", "=", 
                    RowBox[{"2", "^", 
                    RowBox[{"Range", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"Length", "@", "u"}], "-", "1"}]}], "]"}]}]}], 
                    ",", 
                    RowBox[{"Length", "/@", "u"}]}], "}"}]}], "]"}]}]}], 
                   "}"}], "]"}], ",", "First"}], "]"}]}], "}"}], ",", 
             RowBox[{"Dispatch", "@", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"g", "[", 
                 RowBox[{"[", 
                  RowBox[{"All", ",", "1", ",", "1"}], "]"}], "]"}], "->", 
                RowBox[{"Total", "[", 
                 RowBox[{
                  RowBox[{"g", "[", 
                   RowBox[{"[", 
                    RowBox[{"All", ",", "All", ",", "2"}], "]"}], "]"}], ",", 
                  
                  RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}]}], "]"}], ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "r"}], "]"}], ",", "0"}], 
     "]"}]}], "]"}]}]}], "Input",
 CellLabel->"In[78]:=",ExpressionUUID->"e5362512-dddf-42fa-b3b8-ee0896b04e69"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandTensorFi", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTensorFi", "[", 
   RowBox[{"f_dot", ",", "id_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"f", "/.", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{"a__", ",", 
       RowBox[{"F", "[", "id", "]"}], ",", "g___", ",", 
       RowBox[{"F", "[", "id", "]"}], ",", "b__"}], "]"}], ":>", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a", ",", 
        RowBox[{"lI", "[", 
         RowBox[{"id", ",", "1", ",", "1"}], "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"lI", "[", 
         RowBox[{"id", ",", "1", ",", "2"}], "]"}], ",", "g", ",", 
        RowBox[{"lI", "[", 
         RowBox[{"id", ",", "2", ",", "1"}], "]"}]}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"lI", "[", 
         RowBox[{"id", ",", "2", ",", "2"}], "]"}], ",", "b"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "1", ",", "2"}], "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "1", ",", "1"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"p", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "1", ",", "2"}], "]"}], "]"}]}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "2", ",", "1"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "2", ",", "2"}], "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "2", ",", "1"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"p", "[", "id", "]"}], "[", 
          RowBox[{"lI", "[", 
           RowBox[{"id", ",", "2", ",", "2"}], "]"}], "]"}]}]}], ")"}]}]}]}], 
   "/.", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{"a__", ",", 
      RowBox[{"F", "[", "id", "]"}], ",", "b__"}], "]"}], ":>", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{"a", ",", 
       RowBox[{"lI", "[", 
        RowBox[{"id", ",", "1"}], "]"}]}], "]"}], 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"lI", "[", 
        RowBox[{"id", ",", "2"}], "]"}], ",", "b"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"p", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"id", ",", "1"}], "]"}], "]"}], 
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"id", ",", "2"}], "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"id", ",", "1"}], "]"}], "]"}], 
        RowBox[{
         RowBox[{"p", "[", "id", "]"}], "[", 
         RowBox[{"lI", "[", 
          RowBox[{"id", ",", "2"}], "]"}], "]"}]}]}], 
      ")"}]}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "expandTensorFiGen", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandTensorFiGen", "[", 
   RowBox[{"f_", ",", "id_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "res", "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{"f", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g__", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h__"}], "]"}], ",", "2"}], 
           "]"}], ":>", 
          RowBox[{"DC", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"g", ",", 
               RowBox[{"F", "[", "id", "]"}], ",", "h"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "2"}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g__", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h__"}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1__", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h1__"}], "]"}]}], "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h"}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1", ",", 
              RowBox[{"F", "[", "id", "]"}], ",", "h1"}], "]"}]}], "]"}]}]}], 
        "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", "2"}], 
           "]"}], ":>", 
          RowBox[{"DC", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{"g", ",", 
               RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "2"}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g_"}], "]"}], ",",
             "2"}], "]"}], ":>", 
          RowBox[{"DC", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"ii", ",", "2"}], "}"}]}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}]}], "]"}], ":>", 
          
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g_"}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{"g1_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}]}], "]"}], ":>", 
          
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g"}], "]"}], ",", 
            
            RowBox[{"dot", "[", 
             RowBox[{"g1", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g_", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g1_"}], "]"}]}], 
           "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{"g", ",", 
              RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g1"}], "]"}]}], 
           "]"}]}], ",", 
         RowBox[{
          RowBox[{"Times", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g_"}], "]"}], ",", 
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g1_"}], "]"}]}], 
           "]"}], ":>", 
          RowBox[{"DC", "[", 
           RowBox[{
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g"}], "]"}], ",", 
            
            RowBox[{"dot", "[", 
             RowBox[{
              RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g1"}], "]"}]}], 
           "]"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "res", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"res", "/.", 
          RowBox[{
           RowBox[{"dot", "[", "g__", "]"}], ":>", 
           RowBox[{"expandTensorFi", "[", 
            RowBox[{
             RowBox[{"dot", "[", "g", "]"}], ",", "id"}], "]"}]}]}], "/.", 
         RowBox[{
          RowBox[{"dot", "[", 
           RowBox[{"g_", ",", 
            RowBox[{"\[Epsilon]", "[", "id", "]"}]}], "]"}], ":>", 
          RowBox[{
           RowBox[{"g", "[", 
            RowBox[{"lI", "[", 
             RowBox[{"0", ",", "id"}], "]"}], "]"}], 
           RowBox[{
            RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
            RowBox[{"lI", "[", 
             RowBox[{"0", ",", "id"}], "]"}], "]"}]}]}]}], "/.", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "id", "]"}], ",", "g_"}], "]"}], ":>", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"lI", "[", 
            RowBox[{"0", ",", "id"}], "]"}], "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "id", "]"}], "[", 
           RowBox[{"lI", "[", 
            RowBox[{"0", ",", "id"}], "]"}], "]"}]}]}]}], "/.", 
       RowBox[{
        RowBox[{"DC", "[", "g__", "]"}], ":>", 
        RowBox[{"DC", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "g", "}"}], "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"lI", "[", "ids__", "]"}], ":>", 
             RowBox[{"lI", "[", 
              RowBox[{"ii", ",", "ids"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"{", "g", "}"}]}]}], "}"}]}], "]"}]}]}]}], "/.", 
      RowBox[{"DC", "->", "Times"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.8717101857556257`*^9, 3.871710247171233*^9}, {
   3.871710344490424*^9, 3.871710464250885*^9}, {3.871710514216856*^9, 
   3.871710535067227*^9}, {3.871710577772479*^9, 3.871710619653611*^9}, {
   3.87171070099017*^9, 3.871710793817266*^9}, {3.8717110547727757`*^9, 
   3.871711098694851*^9}, {3.871711566802866*^9, 3.8717116001589727`*^9}, {
   3.8717925794231157`*^9, 3.8717926279638968`*^9}, {3.871792658993463*^9, 
   3.871792659631276*^9}, 3.871792836017084*^9, {3.871792881937099*^9, 
   3.871792936440737*^9}, {3.871793027757831*^9, 3.871793027984799*^9}, {
   3.8717930770034943`*^9, 3.8717931563424873`*^9}, {3.871793189683238*^9, 
   3.871793219777211*^9}, {3.871794218005933*^9, 3.8717942969355288`*^9}, {
   3.871794593480941*^9, 3.871794608503077*^9}, {3.871794745604311*^9, 
   3.87179476760977*^9}, {3.871794877507155*^9, 3.871794880713606*^9}, {
   3.871794991131771*^9, 3.87179509392428*^9}, {3.8717951470684958`*^9, 
   3.871795182954617*^9}, {3.8718603028865423`*^9, 3.871860327016007*^9}, {
   3.871860459558563*^9, 3.871860475007077*^9}, {3.871878859716531*^9, 
   3.871878883200115*^9}, {3.871878943674459*^9, 3.8718789878517*^9}, {
   3.871879040687913*^9, 3.871879042718019*^9}, {3.8718797681531343`*^9, 
   3.871879772859611*^9}, {3.8718798541089087`*^9, 3.871880037163097*^9}, {
   3.8765284853468723`*^9, 3.8765285056137733`*^9}, {3.876528614447425*^9, 
   3.8765286203250027`*^9}, {3.876529061202283*^9, 3.876529118675256*^9}, {
   3.876535688731642*^9, 3.876535689308138*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"d380e5eb-db49-4682-929c-e1daabcfeb2e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "GlueAmp2", "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Slow", " ", "function", " ", "for", " ", "testing"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GlueAmp2", "[", 
   RowBox[{"f__", ",", "pi_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", 
      RowBox[{"los", "=", 
       RowBox[{"lo", "@@", "pi"}]}], ",", 
      RowBox[{"lis", "=", "pi"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"Times", "[", "f", "]"}], "/.", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"g_", ",", "vv_", ",", "ps_"}], "]"}], ":>", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"g", "/.", 
           RowBox[{"v", "->", "vv"}]}], "/.", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "@", "ps"}], "]"}]}], ",", "ps"}], "}"}]}], 
           "]"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"res", "//", "expandGen"}], "//", 
         RowBox[{
          RowBox[{"expandF", "[", 
           RowBox[{"#", ",", "lis"}], "]"}], "&"}]}], "//", 
        RowBox[{
         RowBox[{"expandF", "[", 
          RowBox[{"#", ",", "los"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "/.", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a1_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a2_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b1_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b2_", "]"}]}], ":>", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "b1"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"a2", ",", "b2"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "b2"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"a2", ",", "b1"}], "]"}]}], "-", 
            RowBox[{
             FractionBox["2", 
              RowBox[{"DD", "-", "2"}]], 
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "a2"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"b1", ",", "b2"}], "]"}]}]}], ")"}]}]}]}], "//", 
       "contractAnti"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.871712600587709*^9, 3.871712670352553*^9}, {
  3.871712848705008*^9, 3.8717128512044077`*^9}, {3.8717156142755423`*^9, 
  3.871715631992737*^9}, {3.871945244409588*^9, 3.871945272183694*^9}, {
  3.872034874753574*^9, 3.872034875714731*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"796dcd93-6aba-483b-a258-25ceef075ce4"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "GlueAmp3", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GlueAmp3", "[", 
   RowBox[{"f__", ",", "pi_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", 
      RowBox[{"los", "=", 
       RowBox[{"lo", "@@", "pi"}]}], ",", 
      RowBox[{"lis", "=", "pi"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"Times", "[", "f", "]"}], "/.", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"g_", ",", "ps_"}], "]"}], ":>", 
        RowBox[{"(", 
         RowBox[{"g", "/.", 
          RowBox[{"MapThread", "[", 
           RowBox[{"Rule", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "@", "ps"}], "]"}]}], ",", "ps"}], "}"}]}], 
           "]"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "//", 
        RowBox[{
         RowBox[{"expandTensorFiGen", "[", 
          RowBox[{"#", ",", "lis"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "//", 
        RowBox[{
         RowBox[{"expandTensorFiGen", "[", 
          RowBox[{"#", ",", "los"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{"res", "/.", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a1_", "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a2_", "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b1_", "]"}], 
         RowBox[{
          RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b2_", "]"}]}], ":>", 
        
        RowBox[{
         FractionBox["1", "2"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"eta", "[", 
             RowBox[{"a1", ",", "b1"}], "]"}], 
            RowBox[{"eta", "[", 
             RowBox[{"a2", ",", "b2"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"eta", "[", 
             RowBox[{"a1", ",", "b2"}], "]"}], 
            RowBox[{"eta", "[", 
             RowBox[{"a2", ",", "b1"}], "]"}]}], "-", 
           RowBox[{
            FractionBox["2", 
             RowBox[{"DD", "-", "2"}]], 
            RowBox[{"eta", "[", 
             RowBox[{"a1", ",", "a2"}], "]"}], 
            RowBox[{"eta", "[", 
             RowBox[{"b1", ",", "b2"}], "]"}]}]}], ")"}]}]}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.87194534060808*^9, 3.871945346058714*^9}, {
  3.884941034707411*^9, 3.884941039239379*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"e961425d-a95d-4063-8dd3-5034cba1e214"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "GlueAmp", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GlueAmp", "[", 
   RowBox[{"f__", ",", "pi_li"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", 
      RowBox[{"los", "=", 
       RowBox[{"lo", "@@", "pi"}]}], ",", 
      RowBox[{"lis", "=", "pi"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Times", "[", "f", "]"}], "/.", 
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"g_", ",", "ps_"}], "]"}], ":>", 
         RowBox[{"(", 
          RowBox[{"g", "/.", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Rule", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"p", "/@", 
                RowBox[{"Range", "[", 
                 RowBox[{"Length", "@", "ps"}], "]"}]}], ",", "ps"}], "}"}]}],
             "]"}]}], ")"}]}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "//", 
        RowBox[{
         RowBox[{"expandTensorFiGen", "[", 
          RowBox[{"#", ",", "lis"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "//", 
        RowBox[{
         RowBox[{"expandTensorFiGen", "[", 
          RowBox[{"#", ",", "los"}], "]"}], "&"}]}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"res", "/.", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a1_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "lis", "]"}], "[", "a2_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b1_", "]"}], 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", "los", "]"}], "[", "b2_", "]"}]}], ":>", 
         RowBox[{
          FractionBox["1", "2"], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "b1"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"a2", ",", "b2"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "b2"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"a2", ",", "b1"}], "]"}]}], "-", 
            RowBox[{
             FractionBox["2", 
              RowBox[{"DD", "-", "2"}]], 
             RowBox[{"eta", "[", 
              RowBox[{"a1", ",", "a2"}], "]"}], 
             RowBox[{"eta", "[", 
              RowBox[{"b1", ",", "b2"}], "]"}]}]}], ")"}]}]}]}], "//", 
       "contractAnti"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.717672845976037*^9, 3.717672889169771*^9}, {
   3.717674925531893*^9, 3.71767495835476*^9}, {3.717675063695549*^9, 
   3.717675066478118*^9}, {3.717675300930599*^9, 3.7176753267138968`*^9}, {
   3.7176753870934343`*^9, 3.717675403057289*^9}, {3.7176754381874647`*^9, 
   3.71767547431498*^9}, 3.717675660783152*^9, {3.717736602639456*^9, 
   3.7177366242846107`*^9}, {3.717737468069676*^9, 3.717737480653091*^9}, {
   3.717750828787468*^9, 3.717750872340436*^9}, {3.718860636025526*^9, 
   3.718860640412352*^9}, {3.7188607903613377`*^9, 3.718860795560849*^9}, 
   3.71886086446344*^9, {3.718860948446919*^9, 3.718860951595491*^9}, 
   3.718860984899868*^9, {3.721238842235695*^9, 3.721238843744174*^9}, {
   3.721410336076936*^9, 3.7214103369702473`*^9}, {3.721412975267428*^9, 
   3.721412988890263*^9}, {3.72141323618769*^9, 3.7214132364838457`*^9}, 
   3.7214147264125347`*^9, {3.722247891811057*^9, 3.722247901391345*^9}, {
   3.727163630705885*^9, 3.727163679035369*^9}, {3.7271813171878366`*^9, 
   3.727181351523305*^9}, {3.727181477010126*^9, 3.727181501954378*^9}, {
   3.7569617666765738`*^9, 3.756961766784175*^9}, {3.756961870648288*^9, 
   3.756961949579342*^9}, {3.756962094598337*^9, 3.7569621098574553`*^9}, {
   3.756962167672611*^9, 3.7569621739207697`*^9}, {3.7569622139938307`*^9, 
   3.7569622426119537`*^9}, 3.756962373458827*^9, {3.809660362743723*^9, 
   3.809660418070587*^9}, {3.8096614085618067`*^9, 3.809661412551626*^9}, {
   3.809662049147789*^9, 3.809662101747892*^9}, {3.8096621462298317`*^9, 
   3.809662152164967*^9}, {3.809695613944919*^9, 3.809695685233942*^9}, 
   3.809695754647512*^9, {3.809695795605771*^9, 3.809695832316655*^9}, {
   3.809695960033867*^9, 3.809696106429303*^9}, {3.809696168645002*^9, 
   3.8096962031609497`*^9}, {3.80969630311021*^9, 3.809696333870982*^9}, {
   3.809696500996005*^9, 3.809696552942379*^9}, {3.8096965843172007`*^9, 
   3.809696642216886*^9}, {3.80969668037805*^9, 3.809696725452177*^9}, {
   3.8096968004483547`*^9, 3.809696937098598*^9}, {3.8096969918981867`*^9, 
   3.8096970974956913`*^9}, {3.809697150172176*^9, 3.809697151784438*^9}, {
   3.809851404069126*^9, 3.8098514312721767`*^9}, {3.8098515608428*^9, 
   3.8098515619391623`*^9}, {3.81000416196408*^9, 3.81000419966461*^9}, {
   3.810004329672138*^9, 3.810004330140016*^9}, {3.810012567227653*^9, 
   3.8100125857543917`*^9}, {3.849077219402678*^9, 3.8490772205862703`*^9}, {
   3.849077274201914*^9, 3.849077275031169*^9}, {3.8499313915236273`*^9, 
   3.84993139457652*^9}, {3.849936499751693*^9, 3.849936522953876*^9}, {
   3.8500933864282*^9, 3.850093395755972*^9}, {3.8500936471419897`*^9, 
   3.85009368571201*^9}, 3.8518569570609493`*^9, 3.853202602524168*^9, 
   3.853215130512108*^9, 3.857451044110569*^9, 3.871297285245735*^9, {
   3.871619444103547*^9, 3.871619451260944*^9}, {3.871619490117971*^9, 
   3.871619521315403*^9}, {3.871619619378182*^9, 3.87161962417244*^9}, {
   3.8716196556270733`*^9, 3.871619681596793*^9}, {3.871619831706586*^9, 
   3.871619864427882*^9}, {3.8716213205601892`*^9, 3.871621333226293*^9}, {
   3.871625017999157*^9, 3.871625241366728*^9}, {3.871625291216332*^9, 
   3.871625359241075*^9}, {3.871625493107828*^9, 3.8716254955113497`*^9}, {
   3.8716255615364437`*^9, 3.871625564022999*^9}, 3.871625841369969*^9, {
   3.87162607082874*^9, 3.871626075743566*^9}, {3.8716899594033813`*^9, 
   3.8716899600539207`*^9}, {3.8716900784125357`*^9, 
   3.8716900789351377`*^9}, {3.871705590182193*^9, 3.871705593089178*^9}, {
   3.871705721469871*^9, 3.871705813886736*^9}, {3.871705853265871*^9, 
   3.8717058662856207`*^9}, {3.8717059035408707`*^9, 3.871706011684908*^9}, 
   3.871706045343543*^9, {3.871706484816691*^9, 3.87170652555105*^9}, 
   3.8717069814938707`*^9, {3.871707150080432*^9, 3.871707168903172*^9}, {
   3.871707495653973*^9, 3.871707602306806*^9}, {3.8717076664684687`*^9, 
   3.871707692027851*^9}, {3.87170782927689*^9, 3.871707831107004*^9}, {
   3.8717078660880747`*^9, 3.871707868174891*^9}, 3.8717079100251617`*^9, 
   3.871708016362279*^9, 3.871708514321631*^9, {3.871709414281816*^9, 
   3.8717094266664257`*^9}, {3.8717108986134253`*^9, 3.871710934064623*^9}, 
   3.871711118911961*^9, 3.8717113235660048`*^9, 3.871711699746305*^9, {
   3.871711841537026*^9, 3.871711852394979*^9}, {3.871711988334196*^9, 
   3.871712020526985*^9}, {3.871715537622472*^9, 3.871715540368991*^9}, {
   3.872118897251507*^9, 3.872118897481187*^9}, {3.876454167099728*^9, 
   3.876454170049754*^9}, {3.884941025086063*^9, 3.884941028403884*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"317584b1-3576-4b2e-aac2-514fa434a796"]
}, Closed]],

Cell[CellGroupData[{

Cell["MonomialTransformation", "Subsection",
 CellChangeTimes->{{3.871716025388597*^9, 
  3.871716031302944*^9}},ExpressionUUID->"173a1700-15c4-4ea7-a696-\
ba733d3245af"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Mono2List", ",", "deg", ",", "degDotp"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", 
   RowBox[{"f_", ",", "var_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"num", "=", 
       RowBox[{"Numerator", "[", "f", "]"}]}], ",", 
      RowBox[{"den", "=", 
       RowBox[{"Denominator", "[", "f", "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"Plus", "@@@", 
          RowBox[{
           RowBox[{"CoefficientRules", "[", 
            RowBox[{"#", ",", "var"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], "@", 
       RowBox[{"(", "num", ")"}]}], ")"}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"Plus", "@@@", 
          RowBox[{
           RowBox[{"CoefficientRules", "[", 
            RowBox[{"#", ",", "var"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "]"}], "&"}], "@", 
       RowBox[{"(", "den", ")"}]}], ")"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"degDotp", "[", "f_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"deg", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "/.", 
        RowBox[{
         RowBox[{"dot", "[", 
          RowBox[{"a_p", ",", "b_p"}], "]"}], ":>", "x"}]}], "/.", 
       RowBox[{
        RowBox[{"dot", "[", "g__", "]"}], ":>", " ", "1"}]}], " ", ",", 
      RowBox[{"{", "x", "}"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mono2List", "[", 
   RowBox[{"f_", ",", "dimDen_"}], "]"}], ":=", 
  RowBox[{"FF", "[", 
   RowBox[{"1", ",", 
    RowBox[{"-", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"deg", "[", 
        RowBox[{"f", ",", 
         RowBox[{"{", 
          RowBox[{"\[ScriptCapitalD]", "[", "ii", "]"}], "}"}]}], "]"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"ii", ",", "dimDen"}], "}"}]}], "]"}]}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"Mono2List", "[", 
   RowBox[{"f_", ",", "dimDen_List"}], "]"}], ":=", 
  RowBox[{"FF", "[", 
   RowBox[{"1", ",", 
    RowBox[{"-", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"deg", "[", 
        RowBox[{"f", ",", 
         RowBox[{"{", 
          RowBox[{"dimDen", "[", 
           RowBox[{"[", "ii", "]"}], "]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "dimDen"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.871716074820694*^9, 3.8717160840867434`*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"00084e59-1667-45d5-b810-5a3056f0d038"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "GetDenominatorFun", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetDenominatorFun", "[", 
   RowBox[{"h_", ",", "vars_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "alldeno", "}"}], ",", 
    RowBox[{
     RowBox[{"alldeno", "=", 
      RowBox[{"(", 
       RowBox[{"List", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"auxilaryVariables", "*", 
           RowBox[{"Denominator", "[", "h", "]"}]}], "/.", 
          RowBox[{
           RowBox[{"Power", "[", 
            RowBox[{"f_", ",", "n_"}], "]"}], ":>", " ", "f"}]}], ")"}]}], 
       ")"}]}], ";", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"alldeno", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "//", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"#", ",", 
                RowBox[{"dot", "[", "__", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "&"}]}], 
            ",", "vars"}], "]"}], "==", 
          RowBox[{"{", "}"}]}], ",", "Nothing", ",", 
         RowBox[{"alldeno", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "@", "alldeno"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", "GenIBPdotList", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenIBPdotList", "[", 
   RowBox[{"h_", ",", "vars_List", ",", "numeratordots_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pplist", ",", "he"}], "}"}], ",", 
    RowBox[{
     RowBox[{"he", "=", 
      RowBox[{"h", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pplist", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"GetDenominatorFun", "[", 
          RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"List", "@@", "he"}], ")"}]}], "//", "Union"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pplist", "=", 
      RowBox[{"minSets", "[", "pplist", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"pplist", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Intersection", "[", 
           RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", "pplist"}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"pplist", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], ",", "numeratordots"}], "]"}], "//",
          "DeleteDuplicates"}], "//", "Union"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "pplist"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GenIBPdotList", "[", 
   RowBox[{"h_", ",", "vars_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pplist", ",", "he"}], "}"}], ",", 
    RowBox[{
     RowBox[{"he", "=", 
      RowBox[{"h", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pplist", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"GetDenominatorFun", "[", 
          RowBox[{"#", ",", "vars"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"List", "@@", "he"}], ")"}]}], "//", "Union"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pplist", "=", 
      RowBox[{"minSets", "[", "pplist", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"pplist", "[", 
          RowBox[{"[", "ii", "]"}], "]"}], ",", 
         RowBox[{"Complement", "[", 
          RowBox[{"vars", ",", 
           RowBox[{
            RowBox[{"pplist", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "//", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"#", ",", 
               RowBox[{"dot", "[", "__", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "&"}]}]}], 
          "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "@", "pplist"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ClearAll", "[", 
  RowBox[{"mono2j", ",", "mono2B"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mono2j", "[", 
   RowBox[{"g_", ",", "pplist_", ",", "vars_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "numt", ",", "pid", ",", "dds", ",", "dot2D", ",", "propgatorlist"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"numt", "=", "g"}], ";", "\[IndentingNewLine]", 
     RowBox[{"propgatorlist", "=", 
      RowBox[{"GetDenominatorFun", "[", 
       RowBox[{"numt", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pid", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"SubsetQ", "[", 
             RowBox[{"#", ",", "propgatorlist"}], "]"}], "&"}], "/@", 
           "pplist"}], ",", "True"}], "]"}], "//", "Flatten"}], "//", 
       "First"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dds", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[ScriptCapitalD]", "[", "ii", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"pplist", "[", 
            RowBox[{"[", "pid", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dot2D", "=", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"pplist", "[", 
           RowBox[{"[", "pid", "]"}], "]"}], "==", "dds"}], ",", "vars"}], 
        "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{
       RowBox[{"numt", "/.", "dot2D"}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "numt", "]"}], "===", "Plus"}], ",", 
        RowBox[{"List", "@@", "numt"}], ",", 
        RowBox[{"{", "numt", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "numt", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"\[ScriptCapitalD]", "[", "i_", "]"}], ":>", " ", 
             "1"}]}], ")"}], 
          RowBox[{"Mono2List", "[", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", "dds"}], "]"}]}], "/.", 
         RowBox[{
          RowBox[{"FF", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", "f___", "}"}]}], "]"}], ":>", " ", 
          RowBox[{"j", "[", 
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<gr\>\"", "<>", 
              RowBox[{"ToString", "[", "pid", "]"}]}], "]"}], ",", "f"}], 
           "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "numt"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mono2j", "[", 
   RowBox[{"g_", ",", "pplist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "numt", ",", "pid", ",", "dds", ",", "dot2D", ",", "propgatorlist"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"numt", "=", "g"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"propgatorlist", "=", 
        RowBox[{"GetDenominatorFun", "[", 
         RowBox[{"numt", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pid", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SubsetQ", "[", 
               RowBox[{"#", ",", "propgatorlist"}], "]"}], "&"}], "/@", 
             "pplist"}], ",", "True"}], "]"}], "//", "Flatten"}], "//", 
         "First"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"dds", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[ScriptCapitalD]", "[", "ii", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "pplist"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dot2D", "=", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"pplist", "==", "dds"}], ",", "pplist"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{
       RowBox[{"numt", "/.", "dot2D"}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "numt", "]"}], "===", "Plus"}], ",", 
        RowBox[{"List", "@@", "numt"}], ",", 
        RowBox[{"{", "numt", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "numt", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"\[ScriptCapitalD]", "[", "i_", "]"}], ":>", " ", 
             "1"}]}], ")"}], 
          RowBox[{"Mono2List", "[", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", "dds"}], "]"}]}], "/.", 
         RowBox[{
          RowBox[{"FF", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", "f___", "}"}]}], "]"}], ":>", " ", 
          RowBox[{"B", "@@", 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"{", "f", "}"}]}], ")"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "numt"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mono2B", "[", 
   RowBox[{"g_", ",", "pplist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "numt", ",", "pid", ",", "dds", ",", "dot2D", ",", "propgatorlist"}], 
     "}"}], ",", 
    RowBox[{
     RowBox[{"numt", "=", "g"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"propgatorlist", "=", 
        RowBox[{"GetDenominatorFun", "[", 
         RowBox[{"numt", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pid", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"SubsetQ", "[", 
               RowBox[{"#", ",", "propgatorlist"}], "]"}], "&"}], "/@", 
             "pplist"}], ",", "True"}], "]"}], "//", "Flatten"}], "//", 
         "First"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"dds", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"\[ScriptCapitalD]", "[", "ii", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "pplist"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dot2D", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{"pplist", ",", "dds"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{
       RowBox[{"numt", "/.", "dot2D"}], "//", "Expand"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "numt", "]"}], "===", "Plus"}], ",", 
        RowBox[{"List", "@@", "numt"}], ",", 
        RowBox[{"{", "numt", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "numt", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"numt", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"\[ScriptCapitalD]", "[", "i_", "]"}], ":>", " ", 
             "1"}]}], ")"}], 
          RowBox[{"Mono2List", "[", 
           RowBox[{
            RowBox[{"numt", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", "dds"}], "]"}]}], "/.", 
         RowBox[{
          RowBox[{"FF", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", "f___", "}"}]}], "]"}], ":>", " ", 
          RowBox[{"B", "@@", 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"{", "f", "}"}]}], ")"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "numt"}]}], "}"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.87013929658813*^9, 3.87013929709615*^9}, 
   3.87015456888785*^9, {3.870155204422731*^9, 3.870155217666298*^9}, {
   3.8701553410718737`*^9, 3.87015535134295*^9}, 3.870155401400276*^9, {
   3.8704311873876657`*^9, 3.870431268553248*^9}, {3.8705917169072323`*^9, 
   3.870591717418168*^9}, {3.876610362699594*^9, 3.8766104319483433`*^9}, {
   3.876610942764016*^9, 3.876610989180686*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"19df778e-2294-4a99-a897-f608eaf15624"]
}, Closed]],

Cell[CellGroupData[{

Cell["Levi-Civita Expansion", "Subsection",
 CellChangeTimes->{{3.8768839877249594`*^9, 
  3.8768840068850174`*^9}},ExpressionUUID->"dd5b184f-7a98-4933-8d73-\
a01cbd834230"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "etaMatrix", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"etaMatrix", "[", 
    RowBox[{
    "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_", ",", 
     "x7_", ",", "x8_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x1", ",", "x3"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x1", ",", "x4"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x1", ",", "x7"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x1", ",", "x8"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x2", ",", "x3"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x2", ",", "x4"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x2", ",", "x7"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x2", ",", "x8"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x5", ",", "x3"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x5", ",", "x4"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x5", ",", "x7"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x5", ",", "x8"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"x6", ",", "x3"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x6", ",", "x4"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x6", ",", "x7"}], "]"}], ",", 
       RowBox[{"dot", "[", 
        RowBox[{"x6", ",", "x8"}], "]"}]}], "}"}]}], "}"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.87742287808566*^9, 3.8774229129952793`*^9}, {
  3.8774230721070642`*^9, 3.8774230801424713`*^9}, {3.877423501400942*^9, 
  3.877423508889386*^9}, {3.877423973554997*^9, 3.8774239752112007`*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"19e3eae2-e421-46cc-aba5-99b5b0bd9907"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandFS", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandFS", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"f", "//", "expandFDirect"}], ")"}], "/.", 
     RowBox[{
      RowBox[{"dot", "[", "g__", "]"}], ":>", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dot", "[", "g", "]"}], "//", "expandGen"}], ")"}], "//.", 
         
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"S", "[", "ii_", "]"}], "[", 
            RowBox[{"aa_", ",", "b_"}], "]"}], " ", 
           RowBox[{
            RowBox[{"S", "[", "jj_", "]"}], "[", 
            RowBox[{"c_", ",", "d_"}], "]"}]}], ":>", 
          RowBox[{"-", 
           RowBox[{"Det", "[", 
            RowBox[{"etaMatrix", "[", 
             RowBox[{"aa", ",", "b", ",", "c", ",", "d", ",", 
              RowBox[{"p", "[", "ii", "]"}], ",", 
              RowBox[{"a", "[", "ii", "]"}], ",", 
              RowBox[{"p", "[", "jj", "]"}], ",", 
              RowBox[{"a", "[", "jj", "]"}]}], "]"}], "]"}]}]}]}], "//", 
        "contractAnti"}], ")"}]}]}], "//.", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"g1__", ",", 
        RowBox[{"S", "[", "iii_", "]"}], ",", "g2__"}], "]"}], 
      RowBox[{"dot", "[", 
       RowBox[{"g3__", ",", 
        RowBox[{"S", "[", "jjj_", "]"}], ",", "g4__"}], "]"}]}], ":>", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"g1", ",", 
             RowBox[{"S", "[", "iii", "]"}], ",", "g2"}], "]"}], 
           RowBox[{"dot", "[", 
            RowBox[{"g3", ",", 
             RowBox[{"S", "[", "jjj", "]"}], ",", "g4"}], "]"}]}], "//", 
          "expandGen"}], ")"}], "/.", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"S", "[", "ii_", "]"}], "[", 
           RowBox[{"aa_", ",", "b_"}], "]"}], " ", 
          RowBox[{
           RowBox[{"S", "[", "jj_", "]"}], "[", 
           RowBox[{"c_", ",", "d_"}], "]"}]}], ":>", 
         RowBox[{"-", 
          RowBox[{"Det", "[", 
           RowBox[{"etaMatrix", "[", 
            RowBox[{"aa", ",", "b", ",", "c", ",", "d", ",", 
             RowBox[{"p", "[", "ii", "]"}], ",", 
             RowBox[{"a", "[", "ii", "]"}], ",", 
             RowBox[{"p", "[", "jj", "]"}], ",", 
             RowBox[{"a", "[", "jj", "]"}]}], "]"}], "]"}]}]}]}], "//", 
       "contractAnti"}], ")"}]}]}], "//.", 
   RowBox[{
    RowBox[{"Power", "[", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"g1__", ",", 
        RowBox[{"S", "[", "iii_", "]"}], ",", "g2__"}], "]"}], ",", "od_"}], 
     "]"}], ":>", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"dot", "[", 
            RowBox[{"g1", ",", 
             RowBox[{"S", "[", "iii", "]"}], ",", "g2"}], "]"}], 
           RowBox[{"dot", "[", 
            RowBox[{"g1", ",", 
             RowBox[{"S", "[", "iii", "]"}], ",", "g2"}], "]"}]}], "//", 
          "expandGen"}], ")"}], "/.", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"S", "[", "ii_", "]"}], "[", 
           RowBox[{"aa_", ",", "b_"}], "]"}], " ", 
          RowBox[{
           RowBox[{"S", "[", "jj_", "]"}], "[", 
           RowBox[{"c_", ",", "d_"}], "]"}]}], ":>", 
         RowBox[{"-", 
          RowBox[{"Det", "[", 
           RowBox[{"etaMatrix", "[", 
            RowBox[{"aa", ",", "b", ",", "c", ",", "d", ",", 
             RowBox[{"p", "[", "ii", "]"}], ",", 
             RowBox[{"a", "[", "ii", "]"}], ",", 
             RowBox[{"p", "[", "jj", "]"}], ",", 
             RowBox[{"a", "[", "jj", "]"}]}], "]"}], "]"}]}]}]}], "//", 
       "contractAnti"}], ")"}], "*", 
     RowBox[{"Power", "[", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{"g1", ",", 
         RowBox[{"S", "[", "iii", "]"}], ",", "g2"}], "]"}], ",", 
       RowBox[{"od", "-", "2"}]}], "]"}]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.8774239821267138`*^9, 3.877424021716002*^9}, {
   3.87742429888728*^9, 3.877424396304152*^9}, {3.8774246172079277`*^9, 
   3.8774246345014153`*^9}, {3.8794106015020723`*^9, 3.8794107791601*^9}, {
   3.8794640107658367`*^9, 3.8794640635188932`*^9}, {3.879464103579764*^9, 
   3.879464155139634*^9}, {3.879642746561934*^9, 3.8796428220339947`*^9}, {
   3.8796436430854807`*^9, 3.879643650294845*^9}, {3.8796448720658207`*^9, 
   3.8796449046802807`*^9}, {3.8796451320826674`*^9, 
   3.8796451320851593`*^9}, {3.8815341340246067`*^9, 3.88153415559826*^9}, {
   3.884932100745702*^9, 3.884932122930273*^9}, {3.884932160360056*^9, 
   3.8849323391808434`*^9}, 3.8927819671099052`*^9, {3.895553633032577*^9, 
   3.8955536548736553`*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"2c6eaeae-2006-41c5-81d7-a267be9db890"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "expandEps", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expandEps", "[", "f_", "]"}], ":=", 
  RowBox[{"f", "//.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Power", "[", 
       RowBox[{
        RowBox[{"eps", "[", 
         RowBox[{"a1_", ",", "a2_", ",", "a3_", ",", "a4_"}], "]"}], ",", 
        "od_"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Det", "[", 
         RowBox[{"etaMatrix", "[", 
          RowBox[{
          "a3", ",", "a4", ",", "a3", ",", "a4", ",", "a1", ",", "a2", ",", 
           "a1", ",", "a2"}], "]"}], "]"}]}], "*", 
       RowBox[{"Power", "[", 
        RowBox[{
         RowBox[{"eps", "[", 
          RowBox[{"a1", ",", "a2", ",", "a3", ",", "a4"}], "]"}], ",", 
         RowBox[{"od", "-", "2"}]}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"eps", "[", 
        RowBox[{"a1_", ",", "a2_", ",", "a3_", ",", "a4_"}], "]"}], 
       RowBox[{"eps", "[", 
        RowBox[{"b1_", ",", "b2_", ",", "b3_", ",", "b4_"}], "]"}]}], ":>", 
      RowBox[{"-", 
       RowBox[{"Det", "[", 
        RowBox[{"etaMatrix", "[", 
         RowBox[{
         "a3", ",", "a4", ",", "b3", ",", "b4", ",", "a1", ",", "a2", ",", 
          "b1", ",", "b2"}], "]"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"Power", "[", 
       RowBox[{
        RowBox[{"pm", "[", "i_", "]"}], ",", "n_"}], "]"}], ":>", 
      RowBox[{"Power", "[", 
       RowBox[{
        RowBox[{"pm", "[", "i", "]"}], ",", 
        RowBox[{"n", "-", "2"}]}], "]"}]}]}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.896154911526355*^9, 3.896154936796501*^9}, {
  3.8961550260287943`*^9, 3.8961550324461117`*^9}, {3.89666757304674*^9, 
  3.896667578556738*^9}, {3.897948879724492*^9, 3.8979489049474497`*^9}, {
  3.897948950514029*^9, 3.897948977013002*^9}, {3.897949120535406*^9, 
  3.897949129826086*^9}},
 CellLabel->
  "In[2517]:=",ExpressionUUID->"194fddc7-eeb4-4dfd-9214-ee69e2fcf1ae"]
}, Closed]],

Cell[CellGroupData[{

Cell["Spin Ansatz", "Subsection",
 CellChangeTimes->{{3.879499517991712*^9, 
  3.879499521914666*^9}},ExpressionUUID->"9f39f672-655b-4b69-a496-\
a6fc576772a5"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{
  "KSetPartitions", ",", "SetPartitions", ",", "KSetPartitionsEmpty"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"0", ",", " ", "0"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", " ", "0"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"s_List", ",", " ", "0"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"KSetPartitions", "[", 
    RowBox[{"s_List", ",", " ", "k_Integer"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"{", "}"}], " ", "/;", " ", 
    RowBox[{"k", " ", ">", " ", 
     RowBox[{"Length", "[", "s", "]"}]}]}]}], " "}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"s_List", ",", " ", "k_Integer"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", "#1", "}"}], " ", "&"}], " ", ")"}], " ", "/@", " ", 
     "s"}], "}"}], " ", "/;", " ", 
   RowBox[{"k", " ", "===", " ", 
    RowBox[{"Length", "[", "s", "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"s_List", ",", " ", "k_Integer"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"$RecursionLimit", " ", "=", " ", "Infinity"}], ",", " ", 
       "j"}], "}"}], ",", " ", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{"#1", ",", " ", 
            RowBox[{"{", 
             RowBox[{"First", "[", "s", "]"}], "}"}]}], "]"}], " ", "&"}], 
         " ", ")"}], " ", "/@", " ", 
        RowBox[{"KSetPartitions", "[", 
         RowBox[{
          RowBox[{"Rest", "[", "s", "]"}], ",", " ", 
          RowBox[{"k", " ", "-", " ", "1"}]}], "]"}]}], ",", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Prepend", "[", 
               RowBox[{
                RowBox[{"Delete", "[", 
                 RowBox[{"#1", ",", " ", "j"}], "]"}], ",", " ", 
                RowBox[{"Prepend", "[", 
                 RowBox[{
                  RowBox[{"#1", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", " ", 
                  RowBox[{"s", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"j", ",", " ", 
                RowBox[{"Length", "[", "#1", "]"}]}], "}"}]}], "]"}], " ", 
            "&"}], " ", ")"}], " ", "/@", " ", 
          RowBox[{"KSetPartitions", "[", 
           RowBox[{
            RowBox[{"Rest", "[", "s", "]"}], ",", " ", "k"}], "]"}]}], ",", 
         " ", "1"}], "]"}]}], "]"}]}], "]"}], " ", "/;", " ", 
   RowBox[{
    RowBox[{"k", " ", ">", " ", "0"}], " ", "&&", " ", 
    RowBox[{"k", " ", "<", " ", 
     RowBox[{"Length", "[", "s", "]"}]}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{"0", ",", " ", 
    RowBox[{
     RowBox[{"(", "k_Integer", ")"}], "?", "Positive"}]}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"{", "}"}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "n_Integer", ")"}], "?", "Positive"}], ",", " ", "0"}], 
   "]"}], " ", ":=", " ", 
  RowBox[{"{", "}"}]}], "\n", 
 RowBox[{
  RowBox[{"KSetPartitions", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", "n_Integer", ")"}], "?", "Positive"}], ",", " ", 
    RowBox[{
     RowBox[{"(", "k_Integer", ")"}], "?", "Positive"}]}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"KSetPartitions", "[", 
   RowBox[{
    RowBox[{"Range", "[", "n", "]"}], ",", " ", "k"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"SetPartitiona", " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"SetPartitions", "[", 
   RowBox[{"{", "}"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{"{", "}"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"SetPartitions", "[", "s_List", "]"}], " ", ":=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"KSetPartitions", "[", 
       RowBox[{"s", ",", " ", "i"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "2", ",", 
        RowBox[{
         RowBox[{"Length", "[", "s", "]"}], "-", "2"}]}], "}"}]}], "]"}], ",",
     " ", "1"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"SetPartitions", "[", 
   RowBox[{
    RowBox[{"(", "n_Integer", ")"}], "?", "Positive"}], "]"}], " ", ":=", " ", 
  RowBox[{"SetPartitions", "[", 
   RowBox[{"Range", "[", "n", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KSetPartitionsEmpty", "[", 
    RowBox[{"s_List", ",", "k_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"app", ",", "KMod"}], "}"}], ",", 
     RowBox[{
      RowBox[{"app", "=", 
       RowBox[{"KSetPartitions", "[", 
        RowBox[{"s", ",", "k"}], "]"}]}], ";", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"KMod", "=", 
          RowBox[{"KSetPartitions", "[", 
           RowBox[{"s", ",", "q"}], "]"}]}], ";", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"KMod", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{"{", "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"k", "-", "q"}]}], "}"}]}], "]"}], ";", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"app", ",", 
              RowBox[{"KMod", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"KSetPartitions", "[", 
               RowBox[{"s", ",", "q"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"q", ",", "1", ",", 
          RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}], ";", 
      RowBox[{"Return", "[", "app", "]"}]}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.876811307266223*^9, 3.876811357406602*^9}, {
   3.876814773296413*^9, 3.876814814709012*^9}, {3.8768150847160673`*^9, 
   3.876815104266962*^9}, 3.879645132099728*^9},
 CellLabel->
  "In[110]:=",ExpressionUUID->"fb15be39-1e8f-4c4b-9720-110ff700dee0"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "monomialsAnsSingle", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monomialsAnsSingle", "[", 
   RowBox[{"lv_", ",", "od_List", ",", "rv_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "pt", "}"}], ",", 
    RowBox[{
     RowBox[{"pt", "=", 
      RowBox[{
       RowBox[{"Permutations", "[", "od", "]"}], "//", "DeleteDuplicates"}]}],
      ";", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{"lv", ",", "##", ",", "rv"}], "]"}], "&"}], "@@@", "pt"}], 
      ")"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.876804285141453*^9, 3.876804311219627*^9}, {
   3.876804354297196*^9, 3.876804394553791*^9}, {3.876804547147678*^9, 
   3.876804564077526*^9}, 3.8768046310569696`*^9, {3.8768046788966293`*^9, 
   3.876804767317877*^9}, {3.876804900865148*^9, 3.87680509438022*^9}, {
   3.8768051395051527`*^9, 3.876805155807871*^9}, {3.876805253968152*^9, 
   3.876805264267679*^9}, {3.8768053169740458`*^9, 3.876805320484037*^9}, 
   3.876805351239914*^9, {3.8768054423488283`*^9, 3.8768054713281593`*^9}, {
   3.8768055021330214`*^9, 3.876805503038082*^9}, {3.87680557435063*^9, 
   3.8768056288868513`*^9}, {3.876806417065815*^9, 3.876806469431156*^9}, {
   3.876810617157659*^9, 3.876810647969964*^9}, 3.876810746169541*^9, 
   3.877066211011817*^9},
 CellLabel->
  "In[125]:=",ExpressionUUID->"27288c24-ec29-4b53-a711-cf750614f2a9"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "partitions", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partitions", "[", 
   RowBox[{"list_", ",", "l_"}], "]"}], ":=", 
  RowBox[{"Join", "@@", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x", ",", "##"}], "}"}], "&"}], "@@@", 
      RowBox[{"partitions", "[", 
       RowBox[{
        RowBox[{"list", "~", "Complement", "~", "x"}], ",", "l"}], "]"}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Subsets", "[", 
        RowBox[{"list", ",", 
         RowBox[{"{", "l", "}"}], ",", 
         RowBox[{"Binomial", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "list", "]"}], "-", "1"}], ",", 
           RowBox[{"l", "-", "1"}]}], "]"}]}], "]"}]}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"partitions", "[", 
    RowBox[{"list_", ",", "l_"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "[", "list", "]"}], "===", "l"}]}], ":=", 
  RowBox[{"{", 
   RowBox[{"{", "list", "}"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.876813314352524*^9, 3.876813328750271*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"5f986705-e535-4511-b9b5-2363d81b624a"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "monoAllF", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monoAllF", "[", 
   RowBox[{"ptsets_", ",", "vs_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mono1", ",", "mono2", ",", "monoAll", ",", "a"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mono1", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"monomialsAnsSingle", "[", 
              RowBox[{
               RowBox[{"vs", "[", 
                RowBox[{"[", 
                 RowBox[{"jj", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"ptsets", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "jj"}], "]"}], "]"}], ",", 
               RowBox[{"vs", "[", 
                RowBox[{"[", 
                 RowBox[{"jj", ",", "2"}], "]"}], "]"}]}], "]"}], "//", 
             "Total"}], ",", 
            RowBox[{"{", 
             RowBox[{"jj", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"ptsets", "[", 
                RowBox[{"[", "ii", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mono2", "=", 
          RowBox[{"(", 
           RowBox[{"Times", "@@", "mono1"}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"monoAll", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"List", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", "+", "mono2"}], "//", "Expand"}], ")"}]}], ",", 
            "a"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "ptsets"}]}], "}"}]}], "]"}], "//", 
      "Flatten"}], "//", "DeleteDuplicates"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.876811369960775*^9, 3.8768113727341633`*^9}, {
   3.876811485009445*^9, 3.876811595092298*^9}, {3.876811639699731*^9, 
   3.876811640893647*^9}, 3.8768116783304043`*^9, {3.876811716061986*^9, 
   3.876811732470446*^9}, {3.876811790156522*^9, 3.876811796540135*^9}, {
   3.8768118801902447`*^9, 3.876811892921207*^9}, {3.876811927282494*^9, 
   3.876812045955064*^9}, {3.876812090166971*^9, 3.876812166246018*^9}, {
   3.876812217543675*^9, 3.8768122751008883`*^9}, {3.876812307151626*^9, 
   3.876812392859235*^9}, 3.876812451314582*^9, 3.8773367732900352`*^9, {
   3.877344524700871*^9, 3.877344554764751*^9}, {3.8773446377947187`*^9, 
   3.877344642934064*^9}, {3.877344709517954*^9, 3.8773447168750067`*^9}, {
   3.877344826511199*^9, 3.877344918321042*^9}, {3.877351477664247*^9, 
   3.8773514780370626`*^9}, {3.877351529018159*^9, 3.877351561254724*^9}, {
   3.877353282330694*^9, 3.877353342917494*^9}, {3.877353392697257*^9, 
   3.8773534009593678`*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"7212d239-0a48-410c-97d2-2211a59fee4d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dotRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "a_"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{"0", "/;", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"S", "[", "i", "]"}], ",", "b"}], "}"}], "==", 
         RowBox[{"Reverse", "[", 
          RowBox[{"{", 
           RowBox[{"a", ",", 
            RowBox[{"S", "[", "i", "]"}], ",", "b"}], "}"}], "]"}]}], "&&", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"{", "a", "}"}], "]"}], "\[Equal]", 
         RowBox[{"Length", "[", 
          RowBox[{"{", "b", "}"}], "]"}]}]}]}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{"0", "/;", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", 
          RowBox[{"F", "[", "i", "]"}], ",", "b"}], "}"}], "==", 
        RowBox[{"Reverse", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"F", "[", "i", "]"}], ",", "b"}], "}"}], "]"}]}]}]}], ",", 
     
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"H", "[", "i_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{"0", "/;", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", 
          RowBox[{"H", "[", "i", "]"}], ",", "b"}], "}"}], "==", 
        RowBox[{"Reverse", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", 
           RowBox[{"H", "[", "i", "]"}], ",", "b"}], "}"}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "a_"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"H", "[", "i_", "]"}], ",", "a_"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "b_"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{"b", ",", 
          RowBox[{"S", "[", "i", "]"}], ",", "a"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "\[NotEqual]", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "b_"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{"b", ",", 
          RowBox[{"F", "[", "i", "]"}], ",", "a"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "\[NotEqual]", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a_", ",", 
        RowBox[{"H", "[", "i_", "]"}], ",", "b_"}], "]"}], "\[RuleDelayed]", 
      " ", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"dot", "[", 
         RowBox[{"b", ",", 
          RowBox[{"H", "[", "i", "]"}], ",", "a"}], "]"}]}], "/;", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], "]"}], "\[NotEqual]", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "a_", "]"}], ",", 
        RowBox[{"F", "[", "a_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"b__", ",", 
        RowBox[{"F", "[", "a_", "]"}], ",", 
        RowBox[{"p", "[", "a_", "]"}]}], "]"}], "\[RuleDelayed]", " ", "0"}], 
     ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"H", "[", "i_", "]"}], ",", 
        RowBox[{"p", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", " ", "0"}], 
     ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "i_", "]"}], ",", 
        RowBox[{"H", "[", "i_", "]"}], ",", "a__"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"b__", ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", 
        RowBox[{"H", "[", "i_", "]"}], ",", "a__"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"b__", ",", 
        RowBox[{"H", "[", "i_", "]"}], ",", 
        RowBox[{"F", "[", "i_", "]"}], ",", "a__"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", 
        RowBox[{"p", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", " ", "0"}], 
     ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"b__", ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", 
        RowBox[{"a", "[", "j_", "]"}]}], "]"}], "\[RuleDelayed]", " ", "0"}], 
     ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"a", "[", "j_", "]"}], ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "b__"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"a", "[", "i_", "]"}], ",", 
        RowBox[{"p", "[", "i_", "]"}]}], "]"}], "\[RuleDelayed]", " ", "0"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"p", "[", "i_", "]"}], ",", 
        RowBox[{"S", "[", "i_", "]"}], ",", "a__"}], "]"}], "\[RuleDelayed]", 
      " ", "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"a__", ",", 
        RowBox[{"H", "[", "i_", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "i_", "]"}]}], "]"}], ":>", "0"}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "i_", "]"}], ",", 
        RowBox[{"H", "[", "i_", "]"}], ",", "a__"}], "]"}], ":>", "0"}], ",", 
     
     RowBox[{
      RowBox[{"dot", "[", "a__", "]"}], "\[RuleDelayed]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", 
         RowBox[{"Length", "[", 
          RowBox[{"{", "a", "}"}], "]"}]}], "*", 
        RowBox[{"dot", "@@", 
         RowBox[{"Reverse", "[", 
          RowBox[{"{", "a", "}"}], "]"}]}]}], "/;", 
       RowBox[{
        RowBox[{"OrderedQ", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "a", "}"}], "//", "Reverse"}], ",", 
           RowBox[{"{", "a", "}"}]}], "}"}], "]"}], "&&", 
        RowBox[{
         RowBox[{"{", "a", "}"}], "=!=", 
         RowBox[{"Reverse", "[", 
          RowBox[{"{", "a", "}"}], "]"}]}]}]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.87735352765903*^9, 3.877353575291686*^9}, {
   3.877506147842967*^9, 3.877506190551264*^9}, 3.878020458873892*^9, 
   3.878968334460478*^9, {3.8792364567407217`*^9, 3.879236472221311*^9}, 
   3.8792374471519213`*^9, 3.879411830989043*^9, {3.879642906690938*^9, 
   3.8796429172788982`*^9}, {3.879645132103675*^9, 3.879645132106102*^9}, {
   3.884944539337927*^9, 3.884944587032082*^9}, {3.884944643716115*^9, 
   3.8849446465987167`*^9}, {3.8951307882763567`*^9, 3.895130819472924*^9}, {
   3.8960539580039473`*^9, 3.896053972372478*^9}, {3.896054015061367*^9, 
   3.89605402768363*^9}, {3.8960545114894257`*^9, 3.8960545875584497`*^9}, {
   3.896151130539111*^9, 3.896151187972003*^9}, {3.896151442642672*^9, 
   3.896151443861554*^9}, {3.8961515373322363`*^9, 3.896151564113329*^9}, {
   3.896503729857915*^9, 3.896503730274382*^9}, {3.8965037676491756`*^9, 
   3.896503768380728*^9}},
 CellLabel->
  "In[132]:=",ExpressionUUID->"bc1ae754-5343-425f-b62e-83743621db6d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dotH2S", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"a", "[", "4", "]"}], ",", 
        RowBox[{"H", "[", "i_", "]"}], ",", "b_"}], "]"}], ":>", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"\[Epsilon]", "[", "i", "]"}], ",", 
        RowBox[{"S", "[", "i", "]"}], ",", "b"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"b_", ",", 
        RowBox[{"H", "[", "i_", "]"}], ",", 
        RowBox[{"a", "[", "4", "]"}]}], "]"}], ":>", 
      RowBox[{"dot", "[", 
       RowBox[{"b", ",", 
        RowBox[{"S", "[", "i", "]"}], ",", 
        RowBox[{"\[Epsilon]", "[", "i", "]"}]}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dotS2eps", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dot", "[", 
      RowBox[{"b1_", ",", 
       RowBox[{"S", "[", "i_", "]"}], ",", "b2_"}], "]"}], ":>", 
     RowBox[{"-", 
      RowBox[{"eps", "[", 
       RowBox[{
        RowBox[{"p", "[", "i", "]"}], ",", 
        RowBox[{"a", "[", "4", "]"}], ",", "b1", ",", "b2"}], "]"}]}]}], 
    "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.896927984213073*^9, 3.89692803730204*^9}},
 CellLabel->
  "In[133]:=",ExpressionUUID->"078d92fc-ba5c-4517-b82a-1e222cb5c23d"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "evalsc", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evalsc", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"cosh", "->", "Cosh"}], ",", 
     RowBox[{"sinh", "->", "Sinh"}], ",", 
     RowBox[{
      RowBox[{"sinch", "[", "f_", "]"}], ":>", 
      FractionBox[
       RowBox[{"Sinh", "[", "f", "]"}], "f"]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8792207611038017`*^9, 3.87922079447575*^9}, {
  3.879221251565415*^9, 3.879221269755252*^9}, {3.879501721889482*^9, 
  3.8795017552935877`*^9}, {3.8795446031770773`*^9, 3.879544608465846*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"fc29c01e-ec1a-4a7c-b731-f3b14beab4ce"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", 
  RowBox[{"Gsc", ",", "gsc"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gsc", "[", 
   RowBox[{"x1_", ",", "xs__"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rhoa", ",", "rhob", ",", "rholist", ",", "res"}], "}"}], ",", 
    RowBox[{
     RowBox[{"rholist", "=", 
      RowBox[{"KSetPartitionsEmpty", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "xs"}], "}"}], ",", "2"}], "]"}]}], ";", 
     RowBox[{"res", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"rholist", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "2"}], "]"}], "]"}], "===", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"rhob", "=", "1"}], ",", 
           RowBox[{"rhob", "=", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}], "*", 
                  RowBox[{"cosh", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
               RowBox[{"rholist", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "2"}], "]"}], "]"}]}], ")"}]}]}]}], "]"}],
          ";", 
         RowBox[{
          RowBox[{"sinch", "[", 
           RowBox[{"Total", "[", 
            RowBox[{"rholist", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "*", 
          "rhob"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "rholist"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     FractionBox["res", 
      RowBox[{"Times", "[", "xs", "]"}]]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gsc", "[", 
   RowBox[{"id_", ",", "x1_p", ",", "xs___"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rhoa", ",", "rhob", ",", "rholist", ",", "res"}], "}"}], ",", 
    RowBox[{
     RowBox[{"rholist", "=", 
      RowBox[{"KSetPartitionsEmpty", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "xs"}], "}"}], ",", "2"}], "]"}]}], ";", 
     RowBox[{"res", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"rholist", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "2"}], "]"}], "]"}], "===", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"rhob", "=", "1"}], ",", 
           RowBox[{"rhob", "=", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}], "*", 
                  RowBox[{"cosh", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
               RowBox[{"rholist", "[", 
                RowBox[{"[", 
                 RowBox[{"ii", ",", "2"}], "]"}], "]"}]}], ")"}]}]}]}], "]"}],
          ";", 
         RowBox[{
          RowBox[{"sinch", "[", 
           RowBox[{"Total", "[", 
            RowBox[{"rholist", "[", 
             RowBox[{"[", 
              RowBox[{"ii", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "*", 
          "rhob"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "@", "rholist"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      FractionBox["res", 
       RowBox[{"Times", "@@", 
        RowBox[{"(", 
         RowBox[{"{", "xs", "}"}], ")"}]}]], "/.", 
      RowBox[{
       RowBox[{"p", "[", "i__", "]"}], ":>", 
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"a", "[", "id", "]"}], ",", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], "/.", 
          RowBox[{
           RowBox[{"p", "[", "f__", "]"}], ":>", 
           RowBox[{"Total", "[", 
            RowBox[{"p", "/@", 
             RowBox[{"{", "f", "}"}]}], "]"}]}]}]}], "]"}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.879219218140274*^9, 3.879219264939589*^9}, {
   3.879219299355112*^9, 3.879219311698654*^9}, {3.8792193657692842`*^9, 
   3.879219368659751*^9}, {3.879219553770399*^9, 3.879219634556808*^9}, {
   3.8792196730309353`*^9, 3.879219689570814*^9}, {3.8792197387144012`*^9, 
   3.879219835571166*^9}, {3.8792199242952213`*^9, 3.879220015609503*^9}, {
   3.8792200953290052`*^9, 3.879220141518895*^9}, {3.879220441752841*^9, 
   3.879220512676399*^9}, {3.879220602930214*^9, 3.879220634858861*^9}, {
   3.879221324750793*^9, 3.879221360755177*^9}, {3.879232047140245*^9, 
   3.879232163163957*^9}, {3.8792384910478573`*^9, 3.87923854381818*^9}, {
   3.879238579572566*^9, 3.8792385881326838`*^9}, 3.879501692409511*^9, {
   3.879501793232894*^9, 3.8795018057264967`*^9}, {3.879502335648642*^9, 
   3.879502337172986*^9}, {3.8795034317663603`*^9, 3.879503461847233*^9}, 
   3.8795452349277678`*^9, 3.879642929907148*^9, 3.879645132108659*^9, {
   3.884939207324505*^9, 3.8849392229335957`*^9}, {3.888461983453917*^9, 
   3.888461985623866*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"1fbd0d33-3458-4d76-852b-58f4080d5433"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "wtoVS", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wtoVS", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"i__", ",", "j_"}], "]"}], ",", "x__"}], "]"}], ":>", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Cosh", "[", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", 
           RowBox[{"a", "[", "j", "]"}]}], "]"}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"v", "[", "j", "]"}], ",", "x"}], "]"}]}], "-", 
       RowBox[{"I", " ", 
        RowBox[{"(*", 
         FractionBox[
          RowBox[{"Sinh", "[", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"p", "[", "i", "]"}], ",", 
             RowBox[{"a", "[", "j", "]"}]}], "]"}], "]"}], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "i", "]"}], ",", 
            RowBox[{"a", "[", "j", "]"}]}], "]"}]], "*)"}], 
        RowBox[{"G", "[", 
         RowBox[{"j", ",", 
          RowBox[{"p", "[", "i", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"S", "[", "j", "]"}], ",", "x"}], "]"}]}]}]}], ",", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{"x__", ",", 
        RowBox[{"w", "[", 
         RowBox[{"i__", ",", "j_"}], "]"}]}], "]"}], ":>", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Cosh", "[", 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"p", "[", "i", "]"}], ",", 
           RowBox[{"a", "[", "j", "]"}]}], "]"}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{"x", ",", 
          RowBox[{"v", "[", "j", "]"}]}], "]"}]}], "+", 
       RowBox[{"I", " ", 
        RowBox[{"G", "[", 
         RowBox[{"j", ",", 
          RowBox[{"p", "[", "i", "]"}]}], "]"}], 
        RowBox[{"dot", "[", 
         RowBox[{"x", ",", 
          RowBox[{"S", "[", "j", "]"}], ",", 
          RowBox[{"p", "[", "i", "]"}]}], "]"}]}]}]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8796429331538563`*^9, 3.879642946377585*^9}, {
  3.8796451321109943`*^9, 3.879645132116454*^9}, {3.8849344476767483`*^9, 
  3.884934526505649*^9}, {3.884990904721085*^9, 3.8849909610010033`*^9}, {
  3.888288281927598*^9, 3.888288333976241*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"75975a3b-b0aa-411d-aecd-ce1ae1d7321c"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "BoundaryVectorPair", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BoundaryVectorPair", "[", "f_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", "f", "}"}], "/.", 
        RowBox[{
         RowBox[{"a_", " ", "b_"}], ":>", 
         RowBox[{"b", "/;", 
          RowBox[{"NumberQ", "[", "a", "]"}]}]}]}], "/.", 
       RowBox[{"Times", "->", "List"}]}], "/.", 
      RowBox[{
       RowBox[{"Power", "[", 
        RowBox[{"g_", ",", "n_"}], "]"}], ":>", 
       RowBox[{"Table", "[", 
        RowBox[{"g", ",", "n"}], "]"}]}]}], "//", "Flatten"}], ")"}], "/.", 
   RowBox[{"dot", "->", "List"}]}]}]}], "Input",
 CellChangeTimes->{{3.879292514390602*^9, 3.8792925899136953`*^9}, {
  3.879292621607851*^9, 3.879292626222397*^9}, {3.879292679256337*^9, 
  3.879292741125108*^9}, {3.879292853793107*^9, 3.8792928551630287`*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"faf7e0e3-bd4a-4cb0-ac1d-fc631cc8eba1"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "monoFS", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monoFS", "[", 
   RowBox[{"grad_", ",", "Fs_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bvp", ",", "bvpall", ",", "ptsets", ",", "allmonos"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ptsets", "=", 
      RowBox[{"KSetPartitionsEmpty", "[", 
       RowBox[{"Fs", ",", 
        RowBox[{"grad", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "ptsets", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"bvp", "=", 
      RowBox[{"BoundaryVectorPair", "/@", 
       RowBox[{"MonomialList", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"a", "[", "4", "]"}], ",", 
                RowBox[{"a", "[", "4", "]"}]}], "]"}], ")"}], "ii"], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"dot", "[", 
                RowBox[{
                 RowBox[{"p", "[", "4", "]"}], ",", 
                 RowBox[{"p", "[", "4", "]"}]}], "]"}], "+", 
               RowBox[{"dot", "[", 
                RowBox[{
                 RowBox[{"p", "[", "4", "]"}], ",", 
                 RowBox[{"p", "[", "1", "]"}]}], "]"}], "+", 
               RowBox[{"dot", "[", 
                RowBox[{
                 RowBox[{"p", "[", "4", "]"}], ",", 
                 RowBox[{"p", "[", "2", "]"}]}], "]"}], "+", 
               RowBox[{"dot", "[", 
                RowBox[{
                 RowBox[{"p", "[", "1", "]"}], ",", 
                 RowBox[{"p", "[", "2", "]"}]}], "]"}]}], ")"}], "ii"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"p", "[", "4", "]"}], ",", 
                RowBox[{"p", "[", "4", "]"}]}], "]"}], "+", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"p", "[", "4", "]"}], ",", 
                RowBox[{"p", "[", "1", "]"}]}], "]"}], "+", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"p", "[", "4", "]"}], ",", 
                RowBox[{"p", "[", "2", "]"}]}], "]"}], "+", 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"p", "[", "1", "]"}], ",", 
                RowBox[{"p", "[", "2", "]"}]}], "]"}]}], ")"}], 
            SuperscriptBox[
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Total", "[", 
                 RowBox[{"p", "/@", 
                  RowBox[{"Range", "[", "2", "]"}]}], "]"}], "+", 
                RowBox[{"p", "[", "4", "]"}]}], ",", 
               RowBox[{"a", "[", "4", "]"}]}], "]"}], 
             RowBox[{"grad", "-", 
              RowBox[{"2", "ii"}]}]]}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "0", ",", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"IntegerPart", "[", 
               FractionBox["grad", "2"], "]"}]}]}], "}"}]}], "]"}], "//", 
         "Expand"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "bvp", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"bvpall", "=", 
      RowBox[{
       RowBox[{"Join", "@@", 
        RowBox[{"(", 
         RowBox[{"Permutations", "/@", "bvp"}], ")"}]}], "//", "Union"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "bvpall", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"allmonos", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"monoAllF", "[", 
                  RowBox[{"ptsets", ",", "#"}], "]"}], "&"}], "/@", 
                "bvpall"}], ")"}], "//", "Flatten"}], ")"}], "//.", 
            "dotRules"}], 
           RowBox[{"(*", 
            RowBox[{"/.", 
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"p", "[", "1", "]"}], ",", 
                RowBox[{"p", "[", "2", "]"}]}], "]"}], ":>", "0"}]}], "*)"}], 
           "/.", 
           RowBox[{
            RowBox[{"a_", " ", "b_"}], "\[RuleDelayed]", " ", 
            RowBox[{"b", "/;", 
             RowBox[{"NumericQ", "[", "a", "]"}]}]}]}], "//", "Flatten"}], "//",
          "DeleteDuplicates"}], ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "allmonos"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8793054377520638`*^9, 3.879305534073194*^9}, {
   3.879305578534507*^9, 3.8793055802516117`*^9}, {3.879305677449963*^9, 
   3.879305819686283*^9}, {3.879305894700564*^9, 3.8793059195360203`*^9}, {
   3.879306605215102*^9, 3.879306621289269*^9}, {3.8795004168700247`*^9, 
   3.8795004529550877`*^9}, {3.8795027523368998`*^9, 
   3.8795027686155977`*^9}, {3.879502818834166*^9, 3.879502841566842*^9}, {
   3.8795028764251213`*^9, 3.8795028816950903`*^9}, 3.879642946381255*^9, 
   3.879645132119944*^9, {3.896052002203392*^9, 3.896052007549385*^9}, {
   3.89605206254638*^9, 3.8960520790048027`*^9}, {3.8960533286577883`*^9, 
   3.896053356664546*^9}, {3.8960534006061153`*^9, 3.896053427804636*^9}, {
   3.896053503898362*^9, 3.8960535247261763`*^9}, {3.896053576208743*^9, 
   3.896053583935924*^9}, {3.896053702077455*^9, 3.896053712030072*^9}, {
   3.896053746991414*^9, 3.8960537471878233`*^9}, {3.896053841071184*^9, 
   3.896053844215025*^9}, {3.8960554602331448`*^9, 3.8960554631613073`*^9}, {
   3.896066741579996*^9, 3.89606684467134*^9}, {3.896066878139352*^9, 
   3.896066888148087*^9}, {3.896066970745111*^9, 3.8960669729150553`*^9}, {
   3.8960670041774282`*^9, 3.896067006343755*^9}, {3.8960671743824463`*^9, 
   3.896067177953277*^9}, {3.896067213522994*^9, 3.896067215815442*^9}, 
   3.896067932947982*^9, {3.896068124967986*^9, 3.8960681327669277`*^9}, 
   3.896068395906206*^9, 3.896138633407703*^9, {3.8961646544604053`*^9, 
   3.896164655730569*^9}, {3.8961648532802973`*^9, 3.896164854164184*^9}, 
   3.89616490370568*^9, 3.89616680696343*^9, {3.896260714472344*^9, 
   3.896260725412697*^9}, {3.896261140513995*^9, 3.896261151533813*^9}, 
   3.896264605834752*^9, {3.896739473834345*^9, 3.896739475851286*^9}, {
   3.896739742031171*^9, 3.89673974558531*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"0094dab3-dd43-45c3-a7fe-2a53b7c672d8"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "monoFSClassical", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monoFSClassical", "[", 
   RowBox[{"grad_", ",", "Fs_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "bvp", ",", "bvpall", ",", "ptsets", ",", "allmonos", ",", "ptsetsAll"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ptsets", "=", 
      RowBox[{"KSetPartitionsEmpty", "[", 
       RowBox[{"Fs", ",", 
        RowBox[{"grad", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "ptsets", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"bvp", "=", 
      RowBox[{"BoundaryVectorPair", "/@", 
       RowBox[{"MonomialList", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{"a", "[", "4", "]"}], ",", 
                    RowBox[{"a", "[", "4", "]"}]}], "]"}], ")"}], "ii"], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{"p", "[", "4", "]"}], ",", 
                    RowBox[{"p", "[", "4", "]"}]}], "]"}], "+", 
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{"p", "[", "4", "]"}], ",", 
                    RowBox[{"p", "[", "1", "]"}]}], "]"}], "+", 
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{"p", "[", "4", "]"}], ",", 
                    RowBox[{"p", "[", "2", "]"}]}], "]"}], "+", 
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{"p", "[", "1", "]"}], ",", 
                    RowBox[{"p", "[", "2", "]"}]}], "]"}]}], ")"}], "ii"], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{"p", "[", "4", "]"}], ",", 
                    RowBox[{"p", "[", "4", "]"}]}], "]"}], "+", 
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{"p", "[", "4", "]"}], ",", 
                    RowBox[{"p", "[", "1", "]"}]}], "]"}], "+", 
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{"p", "[", "4", "]"}], ",", 
                    RowBox[{"p", "[", "2", "]"}]}], "]"}], "+", 
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{"p", "[", "1", "]"}], ",", 
                    RowBox[{"p", "[", "2", "]"}]}], "]"}]}], ")"}], 
                   SuperscriptBox[
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"p", "/@", 
                    RowBox[{"Range", "[", "2", "]"}]}], "]"}], "+", 
                    RowBox[{"p", "[", "4", "]"}]}], ",", 
                    RowBox[{"a", "[", "4", "]"}]}], "]"}], 
                    RowBox[{"grad", "-", 
                    RowBox[{"2", "ii"}]}]]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"ii", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"IntegerPart", "[", 
                    FractionBox["grad", "2"], "]"}]}]}], "}"}]}], "]"}], "//",
                 "Expand"}], ")"}], "/.", 
              RowBox[{
               RowBox[{"p", "[", "4", "]"}], "->", 
               RowBox[{"t", " ", 
                RowBox[{"p", "[", "4", "]"}]}]}]}], "/.", 
             RowBox[{
              RowBox[{"Power", "[", 
               RowBox[{"t", ",", "ii_"}], "]"}], ":>", 
              RowBox[{"0", "/;", 
               RowBox[{"ii", ">", "4"}]}]}]}], ",", 
            RowBox[{"t", "^", "4"}]}], "]"}], "+", 
          RowBox[{"coef", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{"a", "[", "4", "]"}], ",", 
                    RowBox[{"a", "[", "4", "]"}]}], "]"}], ")"}], "ii"], 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{"p", "[", "4", "]"}], ",", 
                    RowBox[{"p", "[", "4", "]"}]}], "]"}], "+", 
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{"p", "[", "4", "]"}], ",", 
                    RowBox[{"p", "[", "1", "]"}]}], "]"}], "+", 
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{"p", "[", "4", "]"}], ",", 
                    RowBox[{"p", "[", "2", "]"}]}], "]"}], "+", 
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{"p", "[", "1", "]"}], ",", 
                    RowBox[{"p", "[", "2", "]"}]}], "]"}]}], ")"}], "ii"], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{"p", "[", "4", "]"}], ",", 
                    RowBox[{"p", "[", "4", "]"}]}], "]"}], "+", 
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{"p", "[", "4", "]"}], ",", 
                    RowBox[{"p", "[", "1", "]"}]}], "]"}], "+", 
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{"p", "[", "4", "]"}], ",", 
                    RowBox[{"p", "[", "2", "]"}]}], "]"}], "+", 
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{"p", "[", "1", "]"}], ",", 
                    RowBox[{"p", "[", "2", "]"}]}], "]"}]}], ")"}], 
                   SuperscriptBox[
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"p", "/@", 
                    RowBox[{"Range", "[", "2", "]"}]}], "]"}], "+", 
                    RowBox[{"p", "[", "4", "]"}]}], ",", 
                    RowBox[{"a", "[", "4", "]"}]}], "]"}], 
                    RowBox[{"grad", "-", 
                    RowBox[{"2", "ii"}]}]]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"ii", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"IntegerPart", "[", 
                    FractionBox["grad", "2"], "]"}]}]}], "}"}]}], "]"}], "//",
                 "Expand"}], ")"}], "/.", 
              RowBox[{
               RowBox[{"p", "[", "4", "]"}], "->", 
               RowBox[{"t", " ", 
                RowBox[{"p", "[", "4", "]"}]}]}]}], "/.", 
             RowBox[{
              RowBox[{"Power", "[", 
               RowBox[{"t", ",", "ii_"}], "]"}], ":>", 
              RowBox[{"0", "/;", 
               RowBox[{"ii", ">", "3"}]}]}]}], ",", 
            RowBox[{"t", "^", "3"}]}], "]"}]}], "//", "Expand"}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "bvp", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bvpall", "=", 
        RowBox[{
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{"Permutations", "/@", "bvp"}], ")"}]}], "//", "Union"}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ptsetsAll", "=", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Permutations", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"KSetPartitionsEmpty", "[", 
             RowBox[{"Fs", ",", 
              RowBox[{"grad", "+", "1"}]}], "]"}], "//", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{"#", ",", 
               RowBox[{"x_", "/;", 
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{"Length", "/@", "x"}], "]"}], ">", "2"}]}]}], "]"}],
              "&"}]}], ")"}]}], ",", "1"}], "]"}], "//", "Union"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "bvpall", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"allmonos", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"monoAllF", "[", 
                  RowBox[{"ptsetsAll", ",", "#"}], "]"}], "&"}], "/@", 
                "bvp"}], ")"}], "//", "Flatten"}], ")"}], "//.", "dotRules"}], 
           RowBox[{"(*", 
            RowBox[{"/.", 
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"p", "[", "1", "]"}], ",", 
                RowBox[{"p", "[", "2", "]"}]}], "]"}], ":>", "0"}]}], "*)"}], 
           "/.", 
           RowBox[{
            RowBox[{"a_", " ", "b_"}], "\[RuleDelayed]", " ", 
            RowBox[{"b", "/;", 
             RowBox[{"NumericQ", "[", "a", "]"}]}]}]}], "//", "Flatten"}], "//",
          "DeleteDuplicates"}], ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "allmonos"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8976984643241873`*^9, 3.897698484470262*^9}, {
  3.897699121004974*^9, 3.897699123393168*^9}, {3.897699256627284*^9, 
  3.897699258549206*^9}, {3.8977001898697453`*^9, 3.8977002410209913`*^9}, {
  3.897702539029031*^9, 3.89770253934094*^9}, {3.897708043278166*^9, 
  3.8977080497970953`*^9}},
 CellLabel->
  "In[621]:=",ExpressionUUID->"82e8c9c2-a9a8-4862-b428-31505ec6746b"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "monoUFunClassical", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monoUFunClassical", "[", 
   RowBox[{"grad_", ",", "Fs_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "bvp", ",", "bvpall", ",", "ptsets", ",", "allmonos", ",", "ptsetsAll"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ptsets", "=", 
      RowBox[{"KSetPartitionsEmpty", "[", 
       RowBox[{"Fs", ",", 
        RowBox[{"grad", "-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "ptsets", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"bvp", "=", 
      RowBox[{"BoundaryVectorPair", "/@", 
       RowBox[{"MonomialList", "[", 
        RowBox[{
         RowBox[{"coef", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{"a", "[", "4", "]"}], ",", 
                    RowBox[{"a", "[", "4", "]"}]}], "]"}], ")"}], "ii"], 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{"p", "[", "4", "]"}], ",", 
                    RowBox[{"p", "[", "4", "]"}]}], "]"}], ")"}], "ii"], 
                  RowBox[{"(", 
                   RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{"a", "[", "4", "]"}], ",", 
                    RowBox[{"a", "[", "4", "]"}]}], "]"}], ")"}], 
                  SuperscriptBox[
                   RowBox[{"dot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "[", 
                    RowBox[{"p", "/@", 
                    RowBox[{"Range", "[", "2", "]"}]}], "]"}], "+", 
                    RowBox[{"p", "[", "4", "]"}]}], ",", 
                    RowBox[{"a", "[", "4", "]"}]}], "]"}], 
                   RowBox[{"grad", "-", 
                    RowBox[{"2", "ii"}], "-", "2"}]]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"ii", ",", "0", ",", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"IntegerPart", "[", 
                    FractionBox["grad", "2"], "]"}]}]}], "}"}]}], "]"}], "//",
                "Expand"}], ")"}], "/.", 
             RowBox[{
              RowBox[{"p", "[", "4", "]"}], "->", 
              RowBox[{"t", " ", 
               RowBox[{"p", "[", "4", "]"}]}]}]}], "/.", 
            RowBox[{
             RowBox[{"Power", "[", 
              RowBox[{"t", ",", "ii_"}], "]"}], ":>", 
             RowBox[{"0", "/;", 
              RowBox[{"ii", ">", "4"}]}]}]}], ",", 
           RowBox[{"t", "^", "2"}]}], "]"}], "//", "Expand"}], "]"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "bvp", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bvpall", "=", 
        RowBox[{
         RowBox[{"Join", "@@", 
          RowBox[{"(", 
           RowBox[{"Permutations", "/@", "bvp"}], ")"}]}], "//", "Union"}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ptsetsAll", "=", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Permutations", "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"KSetPartitionsEmpty", "[", 
             RowBox[{"Fs", ",", 
              RowBox[{"grad", "-", "1"}]}], "]"}], "//", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{"#", ",", 
               RowBox[{"x_", "/;", 
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{"Length", "/@", "x"}], "]"}], ">", "2"}]}]}], "]"}],
              "&"}]}], ")"}]}], ",", "1"}], "]"}], "//", "Union"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "bvpall", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"allmonos", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"monoAllF", "[", 
                  RowBox[{"ptsetsAll", ",", "#"}], "]"}], "&"}], "/@", 
                "bvp"}], ")"}], "//", "Flatten"}], ")"}], "//.", "dotRules"}], 
           RowBox[{"(*", 
            RowBox[{"/.", 
             RowBox[{
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"p", "[", "1", "]"}], ",", 
                RowBox[{"p", "[", "2", "]"}]}], "]"}], ":>", "0"}]}], "*)"}], 
           "/.", 
           RowBox[{
            RowBox[{"a_", " ", "b_"}], "\[RuleDelayed]", " ", 
            RowBox[{"b", "/;", 
             RowBox[{"NumericQ", "[", "a", "]"}]}]}]}], "//", "Flatten"}], "//",
          "DeleteDuplicates"}], ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "allmonos"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.900104338372789*^9, 3.9001043526134167`*^9}, 
   3.900104383118309*^9},
 CellLabel->
  "In[5365]:=",ExpressionUUID->"d487aeb7-7afc-4f46-b7a9-6769df44212b"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "monoFSCounter", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monoFSCounter", "[", 
   RowBox[{"grad_", ",", "Fs_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bvp", ",", "bvpall", ",", "ptsets", ",", "allmonos"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ptsets", "=", 
      RowBox[{"KSetPartitionsEmpty", "[", 
       RowBox[{"Fs", ",", 
        RowBox[{"grad", "-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "ptsets", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"bvp", "=", 
      RowBox[{"BoundaryVectorPair", "/@", 
       RowBox[{"MonomialList", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{"a", "[", "4", "]"}], ",", 
             RowBox[{"a", "[", "4", "]"}]}], "]"}], ")"}], 
          SuperscriptBox[
           RowBox[{"dot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Total", "[", 
               RowBox[{"p", "/@", 
                RowBox[{"Range", "[", "2", "]"}]}], "]"}], "+", 
              RowBox[{"p", "[", "4", "]"}]}], ",", 
             RowBox[{"a", "[", "4", "]"}]}], "]"}], 
           RowBox[{"grad", "-", "2"}]]}], "//", "Expand"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bvpall", "=", 
      RowBox[{
       RowBox[{"Join", "@@", 
        RowBox[{"(", 
         RowBox[{"Permutations", "/@", "bvp"}], ")"}]}], "//", "Union"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", "bvpall", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"allmonos", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"monoAllF", "[", 
                   RowBox[{"ptsets", ",", "#"}], "]"}], "&"}], "/@", 
                 "bvpall"}], ")"}], "//", "Flatten"}], ")"}], "//.", 
             "dotRules"}], "/.", 
            RowBox[{
             RowBox[{"dot", "[", 
              RowBox[{
               RowBox[{"p", "[", "1", "]"}], ",", 
               RowBox[{"p", "[", "2", "]"}]}], "]"}], ":>", "0"}]}], "/.", 
           RowBox[{
            RowBox[{"a_", " ", "b_"}], "\[RuleDelayed]", " ", 
            RowBox[{"b", "/;", 
             RowBox[{"NumericQ", "[", "a", "]"}]}]}]}], "//", "Flatten"}], "//",
          "DeleteDuplicates"}], ",", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "allmonos"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8960683875442944`*^9, 3.896068389649867*^9}, 
   3.8960684516653433`*^9, {3.896068608265273*^9, 3.8960686305745163`*^9}, 
   3.896068697337453*^9, {3.896068796264112*^9, 3.896068796562482*^9}, 
   3.896138540849764*^9, {3.8976990703893757`*^9, 
   3.897699084305574*^9}},ExpressionUUID->"f6798fa2-d303-4908-aaa4-\
26d9f4f9a84f"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "scExpand", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"scExpand", "[", "i_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "x_", "]"}], ":>", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Normal", "[", 
        RowBox[{"Series", "[", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"tv", " ", "x"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"tv", ",", "0", ",", "i"}], "}"}]}], "]"}], "]"}], "/.", 
       RowBox[{"tv", "->", "1"}]}], ")"}]}], ",", 
    RowBox[{
     RowBox[{"Cosh", "[", "x_", "]"}], ":>", 
     RowBox[{"Normal", "[", 
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"Cosh", "[", "x", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "i"}], "}"}]}], "]"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"Sinh", "[", "x_", "]"}], ":>", 
     RowBox[{"Normal", "[", 
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"Sinh", "[", "x", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "i"}], "}"}]}], "]"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"G", "[", "x__", "]"}], ":>", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Normal", "[", 
        RowBox[{"Series", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"gsc", "[", "x", "]"}], "/.", "evalsc"}], "/.", 
           RowBox[{
            RowBox[{"a", "[", "ii_", "]"}], ":>", 
            RowBox[{"tv", " ", 
             RowBox[{"a", "[", "ii", "]"}]}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"tv", ",", "0", ",", "i"}], "}"}]}], "]"}], "]"}], "/.", 
       RowBox[{"tv", "->", "1"}]}], ")"}]}], ",", 
    RowBox[{
     RowBox[{"Gp", "[", 
      RowBox[{"kk_", ",", "x__"}], "]"}], ":>", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"Series", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"gsc", "[", 
               RowBox[{"kk", ",", "x"}], "]"}], 
              RowBox[{"dot", "[", 
               RowBox[{
                RowBox[{"a", "[", "kk", "]"}], ",", 
                RowBox[{
                 RowBox[{"p", "[", "1", "]"}], "-", 
                 RowBox[{"p", "[", "2", "]"}]}]}], "]"}]], "/.", "evalsc"}], "/.", 
            RowBox[{
             RowBox[{"a", "[", "ii_", "]"}], ":>", 
             RowBox[{"tv", " ", 
              RowBox[{"a", "[", "ii", "]"}]}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"tv", ",", "0", ",", "i"}], "}"}]}], "]"}], "]"}], "/.", 
        RowBox[{"tv", "->", "1"}]}], "//", "Simplify"}], ")"}]}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.895739244076456*^9, 3.895739252337338*^9}, {
  3.895739716461038*^9, 3.895739804079689*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"dce83960-5a3f-4337-9d46-e3386c35e36b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"ta", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "4", "]"}], ",", 
         RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", "I"}], " ", 
         FractionBox[
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "1", "]"}], ",", 
            RowBox[{"S", "[", "4", "]"}], ",", 
            RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], 
          RowBox[{"dot", "[", 
           RowBox[{
            RowBox[{"p", "[", "4", "]"}], ",", 
            RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}]]}], "]"}]}], "//.", 
      RowBox[{"scExpand", "[", "9", "]"}]}], "//", "expandFS"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"ta", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"%", "/.", "dotOnshell"}], "/.", 
      RowBox[{
       RowBox[{"dot", "[", 
        RowBox[{
         RowBox[{"p", "[", "1", "]"}], ",", 
         RowBox[{"p", "[", "4", "]"}]}], "]"}], "->", "0"}]}], "//", 
     "Expand"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"tb", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"dot", "[", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"1", ",", "4"}], "]"}], ",", 
          RowBox[{"\[Epsilon]", "[", "1", "]"}]}], "]"}], "//.", "wtoVS"}], "/.", 
       RowBox[{
        RowBox[{"v", "[", "4", "]"}], "->", 
        RowBox[{"p", "[", "4", "]"}]}]}], "//.", 
      RowBox[{"scExpand", "[", "9", "]"}]}], "//", "Expand"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.895980709938286*^9, 3.895980786050268*^9}, {
   3.8959808707930326`*^9, 3.895980886929552*^9}, {3.895980933618355*^9, 
   3.895980934904332*^9}, {3.895980970736147*^9, 3.895980971534234*^9}, {
   3.8960003799357224`*^9, 3.896000382074436*^9}, {3.896000466116866*^9, 
   3.8960005527907763`*^9}, {3.896000598716527*^9, 3.8960006583577843`*^9}, {
   3.896000693514394*^9, 3.8960007055628147`*^9}, 3.896138483470604*^9},
 CellLabel->
  "In[159]:=",ExpressionUUID->"b2f041e9-91cb-4bb9-9e4e-defe064a00bf"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "Tra", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tra", "[", "ga_List", "]"}], ":=", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "ga", "]"}], "\[Equal]", "0"}], ",", "1", ",", 
     RowBox[{
      RowBox[{"Length", "[", "ga", "]"}], "\[Equal]", "2"}], ",", 
     RowBox[{"4", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"ga", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"ga", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"Length", "[", "ga", "]"}], "\[GreaterEqual]", "4"}], ",", 
     RowBox[{"Total", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "i"], 
         RowBox[{"dot", "[", 
          RowBox[{
           RowBox[{"ga", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"ga", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], 
         RowBox[{"Tra", "[", 
          RowBox[{"Delete", "[", 
           RowBox[{"ga", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", 
              RowBox[{"{", "i", "}"}]}], "}"}]}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "2", ",", 
          RowBox[{"Length", "[", "ga", "]"}]}], "}"}]}], "]"}], "]"}]}], 
    "]"}]}], "\[IndentingNewLine]", " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tra", "[", "a_Plus", "]"}], ":=", 
  RowBox[{"Plus", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Tra", "[", "#", "]"}], "&"}], "/@", "a"}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tra", "[", 
   RowBox[{"c_", " ", "a_CircleTimes"}], "]"}], ":=", 
  RowBox[{"c", " ", 
   RowBox[{"Tra", "[", 
    RowBox[{"a", "/.", 
     RowBox[{"CircleTimes", "\[Rule]", " ", "List"}]}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"Tra", "[", "a_CircleTimes", "]"}], ":=", 
  RowBox[{"Tra", "[", 
   RowBox[{"a", "/.", 
    RowBox[{"CircleTimes", "\[Rule]", " ", "List"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tra", "[", "0", "]"}], "=", " ", "0"}], ";"}]}], "Input",
 CellLabel->
  "In[160]:=",ExpressionUUID->"6f3f0cf2-82ea-42b4-bb83-0cadc74687e4"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples", "Chapter",
 CellChangeTimes->{{3.854428181759294*^9, 
  3.85442818627633*^9}},ExpressionUUID->"2eafdae1-d3d0-40d5-8568-\
3e4019b10f17"],

Cell[CellGroupData[{

Cell["Cubic order Better", "Section",
 CellChangeTimes->{{3.8957386473522043`*^9, 3.895738649590377*^9}, {
  3.895800996813764*^9, 3.895801001783887*^9}, {3.896489912891794*^9, 
  3.896489914238867*^9}, {3.897550091109128*^9, 3.897550099687376*^9}, {
  3.897600228035708*^9, 
  3.897600230968751*^9}},ExpressionUUID->"9e33217e-0937-4ad0-87f7-\
7b1101cc6dd3"],

Cell[CellGroupData[{

Cell["Generating the ansatz", "Subsection",
 CellChangeTimes->{{3.8964910148264217`*^9, 
  3.896491018879407*^9}},ExpressionUUID->"b2e172bb-3284-45b7-a397-\
4af7e390ee89"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"monoFHs1", "=", 
    RowBox[{"monoFSClassical", "[", 
     RowBox[{"3", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"F", "[", "2", "]"}], ",", 
        RowBox[{"F", "[", "1", "]"}], ",", 
        RowBox[{"H", "[", "2", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.896139895570496*^9, 3.896139925442115*^9}, {
  3.896152745538149*^9, 3.8961527654870996`*^9}, {3.8963217429101477`*^9, 
  3.8963217648435593`*^9}, {3.8963226912040033`*^9, 3.896322717667254*^9}, {
  3.896491037565721*^9, 3.8964910737866573`*^9}, {3.897550107247778*^9, 
  3.8975501276725492`*^9}, {3.897600238885543*^9, 3.89760024194786*^9}, {
  3.897729277221177*^9, 3.89772927821558*^9}},
 CellLabel->
  "In[3442]:=",ExpressionUUID->"c756eb27-f8a7-44a4-8cc5-0b111b5a2dee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.882278`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.896139824008565*^9, {3.896139901277143*^9, 3.89613992968966*^9}, 
   3.896150822009251*^9, 3.8961512600879927`*^9, 3.896152767703788*^9, 
   3.896162555315899*^9, 3.8961626774756613`*^9, 3.896164763377441*^9, 
   3.896164955525949*^9, 3.89616683092749*^9, 3.89626076462446*^9, 
   3.8963216476668777`*^9, 3.896321767163348*^9, 3.8963227204246492`*^9, 
   3.896404735791666*^9, 3.896405625658197*^9, 3.896405789978606*^9, 
   3.896407408727853*^9, 3.8964910860871773`*^9, 3.896942671871366*^9, 
   3.896954111141499*^9, {3.897550116213683*^9, 3.897550129044565*^9}, 
   3.897600248149742*^9, 3.897600993035478*^9, 3.897601904685274*^9, 
   3.897604380872896*^9, 3.897611987674246*^9, {3.897729276612221*^9, 
   3.897729279641218*^9}, 3.897869317082591*^9, 3.8978703679781513`*^9, 
   3.8980373905496883`*^9},
 CellLabel->
  "Out[3442]=",ExpressionUUID->"12edca33-a6c7-4d8f-95fa-75fe915d1d0b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"monoUFunClassical", "[", 
  RowBox[{"4", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}], ",", 
     RowBox[{"F", "[", "1", "]"}], ",", 
     RowBox[{"F", "[", "2", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.900203915631605*^9, 3.900203935502246*^9}},
 CellLabel->
  "In[5510]:=",ExpressionUUID->"499b340f-043e-4acf-aaac-c95b1f22f663"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"a", "[", "4", "]"}], ",", 
      RowBox[{"a", "[", "4", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"a", "[", "4", "]"}], ",", 
      RowBox[{"F", "[", "1", "]"}], ",", 
      RowBox[{"F", "[", "2", "]"}], ",", 
      RowBox[{"a", "[", "4", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "4", "]"}], ",", 
      RowBox[{"F", "[", "1", "]"}], ",", 
      RowBox[{"F", "[", "2", "]"}], ",", 
      RowBox[{"p", "[", "4", "]"}]}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"p", "[", "4", "]"}], ",", 
      RowBox[{"p", "[", "4", "]"}]}], "]"}], " ", 
    SuperscriptBox[
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"a", "[", "4", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"a", "[", "4", "]"}]}], "]"}], "2"]}], ",", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"a", "[", "4", "]"}], ",", 
      RowBox[{"a", "[", "4", "]"}]}], "]"}], " ", 
    SuperscriptBox[
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"a", "[", "4", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"p", "[", "4", "]"}]}], "]"}], "2"]}], ",", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"a", "[", "4", "]"}], ",", 
      RowBox[{"a", "[", "4", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"a", "[", "4", "]"}], ",", 
      RowBox[{"F", "[", "1", "]"}], ",", 
      RowBox[{"F", "[", "2", "]"}], ",", 
      RowBox[{"p", "[", "4", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"a", "[", "4", "]"}], ",", 
      RowBox[{"F", "[", "2", "]"}], ",", 
      RowBox[{"F", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "4", "]"}]}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"a", "[", "4", "]"}], ",", 
      RowBox[{"a", "[", "4", "]"}]}], "]"}], " ", 
    SuperscriptBox[
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"a", "[", "4", "]"}], ",", 
       RowBox[{"F", "[", "2", "]"}], ",", 
       RowBox[{"F", "[", "1", "]"}], ",", 
       RowBox[{"p", "[", "4", "]"}]}], "]"}], "2"]}], ",", 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"a", "[", "4", "]"}], ",", 
      RowBox[{"F", "[", "1", "]"}], ",", 
      RowBox[{"p", "[", "4", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"a", "[", "4", "]"}], ",", 
      RowBox[{"F", "[", "2", "]"}], ",", 
      RowBox[{"p", "[", "4", "]"}]}], "]"}], " ", 
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"a", "[", "4", "]"}], ",", 
      RowBox[{"F", "[", "1", "]"}], ",", 
      RowBox[{"F", "[", "2", "]"}], ",", 
      RowBox[{"a", "[", "4", "]"}]}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.900203936540666*^9},
 CellLabel->
  "Out[5510]=",ExpressionUUID->"e97c713d-6d89-43ed-9b4a-117e4d6771c3"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Contact terms", "Chapter",
 CellChangeTimes->{{3.898142442457485*^9, 
  3.898142453955389*^9}},ExpressionUUID->"c04a80ca-a6be-46ea-9a00-\
3d8e5441b610"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"G", "[", 
          RowBox[{"4", ",", 
           RowBox[{"p", "[", "1", "]"}], ",", 
           RowBox[{"p", "[", "2", "]"}]}], "]"}], "/.", 
         RowBox[{"G", "->", "gsc"}]}], "/.", "evalsc"}], "//", "TrigExpand"}],
       "//", "Expand"}], ",", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"a", "[", "4", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "]"}], "-", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"G", "[", 
          RowBox[{"4", ",", 
           RowBox[{"p", "[", "1", "]"}], ",", 
           RowBox[{"p", "[", "2", "]"}]}], "]"}], "/.", 
         RowBox[{"G", "->", "gsc"}]}], "/.", "evalsc"}], "//", "TrigExpand"}],
       "//", "Expand"}], ",", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"a", "[", "4", "]"}], ",", 
       RowBox[{"p", "[", "1", "]"}]}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.898215457122678*^9, 3.8982155183937387`*^9}, {
  3.898215661757156*^9, 3.898215700153734*^9}, {3.898215937349872*^9, 
  3.8982160044016027`*^9}},
 CellLabel->
  "In[4720]:=",ExpressionUUID->"18e6afae-2444-41ee-8ccf-212c585d06e4"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"Cosh", "[", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"a", "[", "4", "]"}], ",", 
       RowBox[{"p", "[", "1", "]"}]}], "]"}], "]"}], " ", 
    RowBox[{"Cosh", "[", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"a", "[", "4", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}], "]"}]}], 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"a", "[", "4", "]"}], ",", 
      RowBox[{"p", "[", "1", "]"}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"a", "[", "4", "]"}], ",", 
        RowBox[{"p", "[", "1", "]"}]}], "]"}], "+", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"a", "[", "4", "]"}], ",", 
        RowBox[{"p", "[", "2", "]"}]}], "]"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"Cosh", "[", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"a", "[", "4", "]"}], ",", 
       RowBox[{"p", "[", "1", "]"}]}], "]"}], "]"}], " ", 
    RowBox[{"Cosh", "[", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"a", "[", "4", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}], "]"}]}], 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"a", "[", "4", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"a", "[", "4", "]"}], ",", 
        RowBox[{"p", "[", "1", "]"}]}], "]"}], "+", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"a", "[", "4", "]"}], ",", 
        RowBox[{"p", "[", "2", "]"}]}], "]"}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"Cosh", "[", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"a", "[", "4", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}], "]"}], " ", 
    RowBox[{"Sinh", "[", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"a", "[", "4", "]"}], ",", 
       RowBox[{"p", "[", "1", "]"}]}], "]"}], "]"}]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"a", "[", "4", "]"}], ",", 
       RowBox[{"p", "[", "1", "]"}]}], "]"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"a", "[", "4", "]"}], ",", 
        RowBox[{"p", "[", "1", "]"}]}], "]"}], "+", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"a", "[", "4", "]"}], ",", 
        RowBox[{"p", "[", "2", "]"}]}], "]"}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"Cosh", "[", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"a", "[", "4", "]"}], ",", 
       RowBox[{"p", "[", "1", "]"}]}], "]"}], "]"}], " ", 
    RowBox[{"Sinh", "[", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"a", "[", "4", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}], "]"}]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"a", "[", "4", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"a", "[", "4", "]"}], ",", 
        RowBox[{"p", "[", "1", "]"}]}], "]"}], "+", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"a", "[", "4", "]"}], ",", 
        RowBox[{"p", "[", "2", "]"}]}], "]"}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"Sinh", "[", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"a", "[", "4", "]"}], ",", 
       RowBox[{"p", "[", "1", "]"}]}], "]"}], "]"}], " ", 
    RowBox[{"Sinh", "[", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"a", "[", "4", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}], "]"}]}], 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"a", "[", "4", "]"}], ",", 
      RowBox[{"p", "[", "1", "]"}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"a", "[", "4", "]"}], ",", 
        RowBox[{"p", "[", "1", "]"}]}], "]"}], "+", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"a", "[", "4", "]"}], ",", 
        RowBox[{"p", "[", "2", "]"}]}], "]"}]}], ")"}]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"Sinh", "[", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"a", "[", "4", "]"}], ",", 
       RowBox[{"p", "[", "1", "]"}]}], "]"}], "]"}], " ", 
    RowBox[{"Sinh", "[", 
     RowBox[{"dot", "[", 
      RowBox[{
       RowBox[{"a", "[", "4", "]"}], ",", 
       RowBox[{"p", "[", "2", "]"}]}], "]"}], "]"}]}], 
   RowBox[{
    RowBox[{"dot", "[", 
     RowBox[{
      RowBox[{"a", "[", "4", "]"}], ",", 
      RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"a", "[", "4", "]"}], ",", 
        RowBox[{"p", "[", "1", "]"}]}], "]"}], "+", 
      RowBox[{"dot", "[", 
       RowBox[{
        RowBox[{"a", "[", "4", "]"}], ",", 
        RowBox[{"p", "[", "2", "]"}]}], "]"}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.89821546972991*^9, 3.898215518922586*^9}, {
  3.898215687432859*^9, 3.898215700750333*^9}, {3.898215957263074*^9, 
  3.898216005192876*^9}},
 CellLabel->
  "Out[4720]=",ExpressionUUID->"90822798-748b-49ea-9018-360a844e58bd"]
}, Open  ]]
}, Open  ]]
},
Evaluator->"M3",
WindowSize->{1413, 870},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>1.25 Inherited,
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (June 19, 2021)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"ab0f726e-def0-4ae4-bafb-008dde361d0a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 161, 3, 87, "Section",ExpressionUUID->"0441e687-3271-491a-8955-dd8d0f7cb479"],
Cell[CellGroupData[{
Cell[766, 29, 328, 6, 50, "Input",ExpressionUUID->"96a2b633-8238-4d8a-95ef-940d2a345ea9"],
Cell[1097, 37, 1460, 21, 50, "Output",ExpressionUUID->"f745a514-280b-4f40-baf0-9a26371777c0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2594, 63, 377, 6, 77, "Input",ExpressionUUID->"9e588303-12c7-48e0-b8a5-8c3c446f4c9f"],
Cell[CellGroupData[{
Cell[2996, 73, 758, 16, 158, "Print",ExpressionUUID->"b58b575a-eb61-4599-97be-c8431aa2cb80"],
Cell[3757, 91, 443, 10, 51, "Print",ExpressionUUID->"79225cc0-e107-4a8d-a993-90a512885c69"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[4249, 107, 195, 3, 50, "Input",ExpressionUUID->"7203740e-5dea-4e1a-af94-e62a7aac051b"],
Cell[4447, 112, 45187, 1098, 1047, "Output",ExpressionUUID->"d1bc3aad-6d3d-46c8-a68a-d0adb7426c33"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49671, 1215, 1293, 31, 155, "Input",ExpressionUUID->"6e78fb49-dd55-4145-92f6-d81f0c875850"],
Cell[CellGroupData[{
Cell[50989, 1250, 2891, 42, 28, "Print",ExpressionUUID->"bb2357e3-7368-4b2c-b5b4-014dc25a4d3a"],
Cell[53883, 1294, 2891, 42, 28, "Print",ExpressionUUID->"3c3aaaa7-0f11-4086-bfa1-8e4e5e9eb6fb"],
Cell[56777, 1338, 2890, 42, 28, "Print",ExpressionUUID->"9f1be2a2-b913-468e-900d-b2d5561cc3dc"],
Cell[59670, 1382, 2902, 43, 28, "Print",ExpressionUUID->"e8ce5606-039c-4eba-ab0b-81d782101309"],
Cell[62575, 1427, 2891, 42, 28, "Print",ExpressionUUID->"3dc66d7b-3ed3-4434-8ccd-a438169f87af"],
Cell[65469, 1471, 2891, 42, 28, "Print",ExpressionUUID->"147b3006-f9c5-473b-8340-0d06f66fb986"],
Cell[68363, 1515, 2891, 42, 28, "Print",ExpressionUUID->"e58d77d5-64ac-439b-a084-03b2cc599d51"],
Cell[71257, 1559, 2900, 43, 28, "Print",ExpressionUUID->"01d469a9-aa67-4fba-8722-1d5ceceb8817"],
Cell[74160, 1604, 2900, 43, 28, "Print",ExpressionUUID->"2dd28bd3-5d25-4a68-a52e-e39ebf17f227"],
Cell[77063, 1649, 2900, 43, 28, "Print",ExpressionUUID->"bacccb1c-04cb-4ab2-8a98-00606d7e20c8"],
Cell[79966, 1694, 2900, 43, 28, "Print",ExpressionUUID->"fba54c61-d39c-4c54-9a72-021755995418"],
Cell[82869, 1739, 2900, 43, 28, "Print",ExpressionUUID->"1b057549-b2db-4e6b-814d-2ca2a4a2d8ed"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[85830, 1789, 157, 3, 68, "Section",ExpressionUUID->"9c1ce1b6-b8bc-4a62-a2fc-094d40b4da22"],
Cell[CellGroupData[{
Cell[86012, 1796, 169, 3, 42, "Subsection",ExpressionUUID->"d2f29554-df37-4996-aba1-a5345b3b87ed"],
Cell[86184, 1801, 1298, 32, 79, "Input",ExpressionUUID->"e20cbbf1-1cdc-4f4d-82ed-9b882eff559a"],
Cell[87485, 1835, 1582, 47, 286, "Input",ExpressionUUID->"cfa2a526-03ef-4db7-81fa-be6f0870607b"],
Cell[89070, 1884, 700, 17, 104, "Input",ExpressionUUID->"b30e5d1f-7ea2-415b-bd9b-f1cbf4f09379"],
Cell[89773, 1903, 852, 21, 104, "Input",ExpressionUUID->"e807e768-058e-43ae-9999-626bd35535d4"],
Cell[90628, 1926, 1257, 34, 130, "Input",ExpressionUUID->"742dd0b6-2e1b-4725-996c-49a833641153"],
Cell[91888, 1962, 2640, 78, 260, "Input",ExpressionUUID->"87bd1bab-44c2-412b-ba82-9f40eb6040fe"],
Cell[94531, 2042, 798, 21, 77, "Input",ExpressionUUID->"305a12e0-d3f9-47a6-890e-663c1dc473f0"],
Cell[95332, 2065, 5177, 125, 260, "Input",ExpressionUUID->"b5cef998-9b4b-4c67-a773-8da59589aa26"],
Cell[100512, 2192, 809, 20, 78, "Input",ExpressionUUID->"287347e7-7a20-4c83-96c2-dc5d1d51baf6"],
Cell[101324, 2214, 1821, 45, 156, "Input",ExpressionUUID->"ea7c9f1f-dd9a-4055-bf49-793acbc051ab"],
Cell[103148, 2261, 2351, 72, 208, "Input",ExpressionUUID->"93a97d95-a81d-46ff-a4cf-cc841727e0d3"],
Cell[105502, 2335, 1197, 35, 156, "Input",ExpressionUUID->"2ea36659-f845-4524-a46d-b556cd85234b"],
Cell[106702, 2372, 560, 15, 78, "Input",ExpressionUUID->"ebfbc6e8-f5f7-42bd-a900-43d5498f6814"]
}, Closed]],
Cell[CellGroupData[{
Cell[107299, 2392, 164, 3, 41, "Subsection",ExpressionUUID->"73b7480f-a370-4824-9379-1e4ba8a3fd1c"],
Cell[107466, 2397, 7163, 196, 467, "Input",ExpressionUUID->"41043e5a-5d19-4d2a-af02-09fa94f97da7"],
Cell[114632, 2595, 1847, 54, 155, "Input",ExpressionUUID->"c577fd7b-c851-4cd8-a400-9809d2d19cf2"],
Cell[116482, 2651, 4531, 124, 415, "Input",ExpressionUUID->"101282f6-ddf7-4c34-b35b-ecbb54c60d3b"],
Cell[121016, 2777, 3427, 92, 311, "Input",ExpressionUUID->"c42f75c8-120b-48db-bbf0-433b064efe67"],
Cell[124446, 2871, 2468, 71, 257, "Input",ExpressionUUID->"2adab730-0fcf-4c5a-a80b-c851d9614d46"],
Cell[126917, 2944, 1588, 44, 181, "Input",ExpressionUUID->"5936a091-d150-4130-84a8-31c559d8a8d6"],
Cell[128508, 2990, 1310, 30, 103, "Input",ExpressionUUID->"5d1c4dbf-4db1-411d-9eb2-91f10d2e4065"],
Cell[129821, 3022, 3076, 88, 435, "Input",ExpressionUUID->"be8084ef-54f7-48de-90e1-cb41967ce54b"],
Cell[132900, 3112, 1227, 32, 103, "Input",ExpressionUUID->"cfbe45c5-f9c8-4198-8910-2ad2f83921b4"],
Cell[134130, 3146, 611, 16, 77, "Input",ExpressionUUID->"4d2ef866-ff12-48be-a749-98a60647b861"],
Cell[134744, 3164, 2225, 56, 363, "Input",ExpressionUUID->"e5362512-dddf-42fa-b3b8-ee0896b04e69"],
Cell[136972, 3222, 13005, 339, 675, "Input",ExpressionUUID->"d380e5eb-db49-4682-929c-e1daabcfeb2e"],
Cell[149980, 3563, 3197, 86, 298, "Input",ExpressionUUID->"796dcd93-6aba-483b-a258-25ceef075ce4"],
Cell[153180, 3651, 2869, 80, 272, "Input",ExpressionUUID->"e961425d-a95d-4063-8dd3-5034cba1e214"],
Cell[156052, 3733, 7423, 142, 325, "Input",ExpressionUUID->"317584b1-3576-4b2e-aac2-514fa434a796"]
}, Closed]],
Cell[CellGroupData[{
Cell[163512, 3880, 170, 3, 41, "Subsection",ExpressionUUID->"173a1700-15c4-4ea7-a696-ba733d3245af"],
Cell[163685, 3885, 2837, 86, 232, "Input",ExpressionUUID->"00084e59-1667-45d5-b810-5a3056f0d038"],
Cell[166525, 3973, 14237, 395, 1715, "Input",ExpressionUUID->"19df778e-2294-4a99-a897-f608eaf15624"]
}, Closed]],
Cell[CellGroupData[{
Cell[180799, 4373, 173, 3, 41, "Subsection",ExpressionUUID->"dd5b184f-7a98-4933-8d73-a01cbd834230"],
Cell[180975, 4378, 2008, 55, 182, "Input",ExpressionUUID->"19e3eae2-e421-46cc-aba5-99b5b0bd9907"],
Cell[182986, 4435, 4993, 129, 416, "Input",ExpressionUUID->"2c6eaeae-2006-41c5-81d7-a267be9db890"],
Cell[187982, 4566, 1983, 51, 260, "Input",ExpressionUUID->"194fddc7-eeb4-4dfd-9214-ee69e2fcf1ae"]
}, Closed]],
Cell[CellGroupData[{
Cell[190002, 4622, 159, 3, 41, "Subsection",ExpressionUUID->"9f39f672-655b-4b69-a496-a6fc576772a5"],
Cell[190164, 4627, 6804, 194, 598, "Input",ExpressionUUID->"fb15be39-1e8f-4c4b-9720-110ff700dee0"],
Cell[196971, 4823, 1460, 32, 104, "Input",ExpressionUUID->"27288c24-ec29-4b53-a711-cf750614f2a9"],
Cell[198434, 4857, 1266, 37, 130, "Input",ExpressionUUID->"5f986705-e535-4511-b9b5-2363d81b624a"],
Cell[199703, 4896, 2943, 67, 182, "Input",ExpressionUUID->"7212d239-0a48-410c-97d2-2211a59fee4d"],
Cell[202649, 4965, 8740, 240, 364, "Input",ExpressionUUID->"bc1ae754-5343-425f-b62e-83743621db6d"],
Cell[211392, 5207, 1321, 39, 78, "Input",ExpressionUUID->"078d92fc-ba5c-4517-b82a-1e222cb5c23d"],
Cell[212716, 5248, 689, 16, 99, "Input",ExpressionUUID->"fc29c01e-ec1a-4a7c-b731-f3b14beab4ce"],
Cell[213408, 5266, 5396, 140, 393, "Input",ExpressionUUID->"1fbd0d33-3458-4d76-852b-58f4080d5433"],
Cell[218807, 5408, 2490, 69, 123, "Input",ExpressionUUID->"75975a3b-b0aa-411d-aecd-ce1ae1d7321c"],
Cell[221300, 5479, 1033, 27, 78, "Input",ExpressionUUID->"faf7e0e3-bd4a-4cb0-ac1d-fc631cc8eba1"],
Cell[222336, 5508, 6793, 157, 527, "Input",ExpressionUUID->"0094dab3-dd43-45c3-a7fe-2a53b7c672d8"],
Cell[229132, 5667, 10493, 256, 754, "Input",ExpressionUUID->"82e8c9c2-a9a8-4862-b428-31505ec6746b"],
Cell[239628, 5925, 5571, 146, 571, "Input",ExpressionUUID->"d487aeb7-7afc-4f46-b7a9-6769df44212b"],
Cell[245202, 6073, 3172, 83, 320, "Input",ExpressionUUID->"f6798fa2-d303-4908-aaa4-26d9f4f9a84f"],
Cell[248377, 6158, 2923, 82, 164, "Input",ExpressionUUID->"dce83960-5a3f-4337-9d46-e3386c35e36b"],
Cell[251303, 6242, 2179, 58, 116, "Input",ExpressionUUID->"b2f041e9-91cb-4bb9-9e4e-defe064a00bf"],
Cell[253485, 6302, 2358, 69, 252, "Input",ExpressionUUID->"6f3f0cf2-82ea-42b4-bb83-0cadc74687e4"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[255892, 6377, 152, 3, 71, "Chapter",ExpressionUUID->"2eafdae1-d3d0-40d5-8568-3e4019b10f17"],
Cell[CellGroupData[{
Cell[256069, 6384, 358, 6, 87, "Section",ExpressionUUID->"9e33217e-0937-4ad0-87f7-7b1101cc6dd3"],
Cell[CellGroupData[{
Cell[256452, 6394, 171, 3, 42, "Subsection",ExpressionUUID->"b2e172bb-3284-45b7-a397-4af7e390ee89"],
Cell[CellGroupData[{
Cell[256648, 6401, 889, 20, 51, "Input",ExpressionUUID->"c756eb27-f8a7-44a4-8cc5-0b111b5a2dee"],
Cell[257540, 6423, 1000, 17, 51, "Output",ExpressionUUID->"12edca33-a6c7-4d8f-95fa-75fe915d1d0b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[258577, 6445, 436, 11, 51, "Input",ExpressionUUID->"499b340f-043e-4acf-aaac-c95b1f22f663"],
Cell[259016, 6458, 3095, 92, 110, "Output",ExpressionUUID->"e97c713d-6d89-43ed-9b4a-117e4d6771c3"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[262184, 6558, 158, 3, 86, "Chapter",ExpressionUUID->"c04a80ca-a6be-46ea-9a00-3d8e5441b610"],
Cell[CellGroupData[{
Cell[262367, 6565, 1346, 40, 104, "Input",ExpressionUUID->"18e6afae-2444-41ee-8ccf-212c585d06e4"],
Cell[263716, 6607, 5317, 170, 177, "Output",ExpressionUUID->"90822798-748b-49ea-9018-360a844e58bd"]
}, Open  ]]
}, Open  ]]
}
]
*)

